<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Hadley Wickham, Mine Ã‡etinkaya-Rundel, and Garrett Grolemund">
<title>14&nbsp; Strings â€“ R æ•°æ®ç§‘å­¦ 2e</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./regexps.html" rel="next">
<link href="./numbers.html" rel="prev">
<link href="./cover.jpg" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-cfa698a38273543b64ee69d493127e2a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script defer="" data-domain="r4ds.hadley.nz" src="https://plausible.io/js/plausible.js"></script>
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./transform.html">Transform</a></li><li class="breadcrumb-item"><a href="./strings.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Strings</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R æ•°æ®ç§‘å­¦ 2e</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ggvisPro/r4ds-cn/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface-2e.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface to the second edition</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./whole-game.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Whole game</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-visualize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Data visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workflow-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Workflow: basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data transformation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workflow-style.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Workflow: code style</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-tidy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data tidying</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workflow-scripts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Workflow: scripts and projects</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data import</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workflow-help.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Workflow: getting help</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./visualize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualize</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./layers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Layers</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./EDA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Exploratory data analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./communication.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Communication</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transform</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logicals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Logical vectors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Numbers</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./strings.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Strings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regexps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Regular expressions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./factors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Factors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datetimes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Dates and times</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missing-values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Missing values</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./joins.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Joins</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">å¯¼å…¥</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spreadsheets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">ç”µå­è¡¨æ ¼</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./databases.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">æ•°æ®åº“</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./arrow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Arrow</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rectangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">å±‚çº§æ•°æ®</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./webscraping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">ç½‘ç»œæŠ“å–</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./program.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ç¼–ç¨‹</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">å‡½æ•°</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./iteration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">è¿­ä»£</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./base-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Base R å®æˆ˜æŒ‡å—</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./communicate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">æ²Ÿé€š</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quarto-formats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Quarto æ ¼å¼</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">14.1</span> Introduction</a>
  <ul class="collapse">
<li><a href="#prerequisites" id="toc-prerequisites" class="nav-link" data-scroll-target="#prerequisites"><span class="header-section-number">14.1.1</span> Prerequisites</a></li>
  </ul>
</li>
  <li>
<a href="#creating-a-string" id="toc-creating-a-string" class="nav-link" data-scroll-target="#creating-a-string"><span class="header-section-number">14.2</span> Creating a string</a>
  <ul class="collapse">
<li><a href="#escapes" id="toc-escapes" class="nav-link" data-scroll-target="#escapes"><span class="header-section-number">14.2.1</span> Escapes</a></li>
  <li><a href="#sec-raw-strings" id="toc-sec-raw-strings" class="nav-link" data-scroll-target="#sec-raw-strings"><span class="header-section-number">14.2.2</span> Raw strings</a></li>
  <li><a href="#other-special-characters" id="toc-other-special-characters" class="nav-link" data-scroll-target="#other-special-characters"><span class="header-section-number">14.2.3</span> Other special characters</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">14.2.4</span> Exercises</a></li>
  </ul>
</li>
  <li>
<a href="#creating-many-strings-from-data" id="toc-creating-many-strings-from-data" class="nav-link" data-scroll-target="#creating-many-strings-from-data"><span class="header-section-number">14.3</span> Creating many strings from data</a>
  <ul class="collapse">
<li><a href="#str_c" id="toc-str_c" class="nav-link" data-scroll-target="#str_c"><span class="header-section-number">14.3.1</span> <code>str_c()</code></a></li>
  <li><a href="#sec-glue" id="toc-sec-glue" class="nav-link" data-scroll-target="#sec-glue"><span class="header-section-number">14.3.2</span> <code>str_glue()</code></a></li>
  <li><a href="#str_flatten" id="toc-str_flatten" class="nav-link" data-scroll-target="#str_flatten"><span class="header-section-number">14.3.3</span> <code>str_flatten()</code></a></li>
  <li><a href="#exercises-1" id="toc-exercises-1" class="nav-link" data-scroll-target="#exercises-1"><span class="header-section-number">14.3.4</span> Exercises</a></li>
  </ul>
</li>
  <li>
<a href="#extracting-data-from-strings" id="toc-extracting-data-from-strings" class="nav-link" data-scroll-target="#extracting-data-from-strings"><span class="header-section-number">14.4</span> Extracting data from strings</a>
  <ul class="collapse">
<li><a href="#separating-into-rows" id="toc-separating-into-rows" class="nav-link" data-scroll-target="#separating-into-rows"><span class="header-section-number">14.4.1</span> Separating into rows</a></li>
  <li><a href="#sec-string-columns" id="toc-sec-string-columns" class="nav-link" data-scroll-target="#sec-string-columns"><span class="header-section-number">14.4.2</span> Separating into columns</a></li>
  <li><a href="#diagnosing-widening-problems" id="toc-diagnosing-widening-problems" class="nav-link" data-scroll-target="#diagnosing-widening-problems"><span class="header-section-number">14.4.3</span> Diagnosing widening problems</a></li>
  </ul>
</li>
  <li>
<a href="#letters" id="toc-letters" class="nav-link" data-scroll-target="#letters"><span class="header-section-number">14.5</span> Letters</a>
  <ul class="collapse">
<li><a href="#length" id="toc-length" class="nav-link" data-scroll-target="#length"><span class="header-section-number">14.5.1</span> Length</a></li>
  <li><a href="#subsetting" id="toc-subsetting" class="nav-link" data-scroll-target="#subsetting"><span class="header-section-number">14.5.2</span> Subsetting</a></li>
  <li><a href="#exercises-2" id="toc-exercises-2" class="nav-link" data-scroll-target="#exercises-2"><span class="header-section-number">14.5.3</span> Exercises</a></li>
  </ul>
</li>
  <li>
<a href="#sec-other-languages" id="toc-sec-other-languages" class="nav-link" data-scroll-target="#sec-other-languages"><span class="header-section-number">14.6</span> Non-English text</a>
  <ul class="collapse">
<li><a href="#encoding" id="toc-encoding" class="nav-link" data-scroll-target="#encoding"><span class="header-section-number">14.6.1</span> Encoding</a></li>
  <li><a href="#letter-variations" id="toc-letter-variations" class="nav-link" data-scroll-target="#letter-variations"><span class="header-section-number">14.6.2</span> Letter variations</a></li>
  <li><a href="#locale-dependent-functions" id="toc-locale-dependent-functions" class="nav-link" data-scroll-target="#locale-dependent-functions"><span class="header-section-number">14.6.3</span> Locale-dependent functions</a></li>
  </ul>
</li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">14.7</span> Summary</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/ggvisPro/r4ds-cn/edit/main/strings.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/ggvisPro/r4ds-cn/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./transform.html">Transform</a></li><li class="breadcrumb-item"><a href="./strings.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Strings</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-strings" class="quarto-section-identifier"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Strings</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="introduction" class="level2" data-number="14.1"><h2 data-number="14.1" class="anchored" data-anchor-id="introduction">
<span class="header-section-number">14.1</span> Introduction</h2>
<p>So far, youâ€™ve used a bunch of strings without learning much about the details. Now itâ€™s time to dive into them, learn what makes strings tick, and master some of the powerful string manipulation tools you have at your disposal.<br>
åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä½ å·²ç»ä½¿ç”¨äº†å¾ˆå¤šå­—ç¬¦ä¸²ï¼Œä½†æ²¡æœ‰å­¦ä¹ å¤ªå¤šç»†èŠ‚ã€‚ç°åœ¨æ˜¯æ—¶å€™æ·±å…¥ç ”ç©¶å®ƒä»¬ï¼Œäº†è§£å­—ç¬¦ä¸²çš„å·¥ä½œåŸç†ï¼Œå¹¶æŒæ¡ä¸€äº›ä½ å¯ä»¥ä½¿ç”¨çš„å¼ºå¤§å­—ç¬¦ä¸²æ“ä½œå·¥å…·äº†ã€‚</p>
<p>Weâ€™ll begin with the details of creating strings and character vectors. Youâ€™ll then dive into creating strings from data, then the opposite: extracting strings from data. Weâ€™ll then discuss tools that work with individual letters. The chapter finishes with functions that work with individual letters and a brief discussion of where your expectations from English might steer you wrong when working with other languages.<br>
æˆ‘ä»¬å°†ä»åˆ›å»ºå­—ç¬¦ä¸²å’Œå­—ç¬¦å‘é‡çš„ç»†èŠ‚å¼€å§‹ã€‚ç„¶åä½ å°†æ·±å…¥å­¦ä¹ å¦‚ä½•ä»æ•°æ®åˆ›å»ºå­—ç¬¦ä¸²ï¼Œä»¥åŠåè¿‡æ¥ï¼šä»æ•°æ®ä¸­æå–å­—ç¬¦ä¸²ã€‚æ¥ç€æˆ‘ä»¬å°†è®¨è®ºå¤„ç†å•ä¸ªå­—æ¯çš„å·¥å…·ã€‚æœ¬ç« æœ€åä¼šä»‹ç»å¤„ç†å•ä¸ªå­—æ¯çš„å‡½æ•°ï¼Œå¹¶ç®€è¦è®¨è®ºåœ¨å¤„ç†å…¶ä»–è¯­è¨€æ—¶ï¼Œä½ åŸºäºè‹±è¯­çš„é¢„æœŸå¯èƒ½ä¼šå¦‚ä½•è¯¯å¯¼ä½ ã€‚</p>
<p>Weâ€™ll keep working with strings in the next chapter, where youâ€™ll learn more about the power of regular expressions.<br>
åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†ç»§ç»­å­¦ä¹ å­—ç¬¦ä¸²ï¼Œå±Šæ—¶ä½ å°†äº†è§£æ›´å¤šå…³äºæ­£åˆ™è¡¨è¾¾å¼ (regular expressions) çš„å¼ºå¤§åŠŸèƒ½ã€‚</p>
<section id="prerequisites" class="level3" data-number="14.1.1"><h3 data-number="14.1.1" class="anchored" data-anchor-id="prerequisites">
<span class="header-section-number">14.1.1</span> Prerequisites</h3>
<p>In this chapter, weâ€™ll use functions from the stringr package, which is part of the core tidyverse. Weâ€™ll also use the babynames data since it provides some fun strings to manipulate.<br>
åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ stringr åŒ…ä¸­çš„å‡½æ•°ï¼Œå®ƒæ˜¯æ ¸å¿ƒ tidyverse çš„ä¸€éƒ¨åˆ†ã€‚æˆ‘ä»¬è¿˜å°†ä½¿ç”¨ babynames æ•°æ®ï¼Œå› ä¸ºå®ƒæä¾›äº†ä¸€äº›æœ‰è¶£çš„å­—ç¬¦ä¸²å¯ä¾›æ“ä½œã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/babynames">babynames</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can quickly tell when youâ€™re using a stringr function because all stringr functions start with <code>str_</code>. This is particularly useful if you use RStudio because typing <code>str_</code> will trigger autocomplete, allowing you to jog your memory of the available functions.<br>
ä½ å¯ä»¥å¾ˆå¿«åˆ¤æ–­å‡ºä½ æ­£åœ¨ä½¿ç”¨çš„æ˜¯ stringr å‡½æ•°ï¼Œå› ä¸ºæ‰€æœ‰çš„ stringr å‡½æ•°éƒ½ä»¥ <code>str_</code> å¼€å¤´ã€‚å¦‚æœä½ ä½¿ç”¨ RStudioï¼Œè¿™ä¸€ç‚¹ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºè¾“å…¥ <code>str_</code> ä¼šè§¦å‘è‡ªåŠ¨è¡¥å…¨ï¼Œä»è€Œå¸®åŠ©ä½ è®°èµ·å¯ç”¨çš„å‡½æ•°ã€‚</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="screenshots/stringr-autocomplete.png" class="img-fluid figure-img" alt="str_c typed into the RStudio console with the autocomplete tooltip shown  on top, which lists functions beginning with str_c. The funtion signature  and beginning of the man page for the highlighted function from the  autocomplete list are shown in a panel to its right." width="678"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="creating-a-string" class="level2" data-number="14.2"><h2 data-number="14.2" class="anchored" data-anchor-id="creating-a-string">
<span class="header-section-number">14.2</span> Creating a string</h2>
<p>Weâ€™ve created strings in passing earlier in the book but didnâ€™t discuss the details. Firstly, you can create a string using either single quotes (<code>'</code>) or double quotes (<code>"</code>). Thereâ€™s no difference in behavior between the two, so in the interests of consistency, the <a href="https://style.tidyverse.org/syntax.html#character-vectors">tidyverse style guide</a> recommends using <code>"</code>, unless the string contains multiple <code>"</code>.<br>
åœ¨æœ¬ä¹¦å‰é¢éƒ¨åˆ†ï¼Œæˆ‘ä»¬ä¸ç»æ„é—´åˆ›å»ºäº†å­—ç¬¦ä¸²ï¼Œä½†æ²¡æœ‰è®¨è®ºç»†èŠ‚ã€‚é¦–å…ˆï¼Œä½ å¯ä»¥ä½¿ç”¨å•å¼•å· (<code>'</code>) æˆ–åŒå¼•å· (<code>"</code>) æ¥åˆ›å»ºå­—ç¬¦ä¸²ã€‚ä¸¤è€…åœ¨è¡Œä¸ºä¸Šæ²¡æœ‰åŒºåˆ«ï¼Œå› æ­¤ä¸ºäº†ä¿æŒä¸€è‡´æ€§ï¼Œ<a href="https://style.tidyverse.org/syntax.html#character-vectors">tidyverse é£æ ¼æŒ‡å—</a> å»ºè®®ä½¿ç”¨ <code>"</code>ï¼Œé™¤éå­—ç¬¦ä¸²æœ¬èº«åŒ…å«å¤šä¸ª <code>"</code>ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">string1</span> <span class="op">&lt;-</span> <span class="st">"This is a string"</span></span>
<span><span class="va">string2</span> <span class="op">&lt;-</span> <span class="st">'If I want to include a "quote" inside a string, I use single quotes'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If you forget to close a quote, youâ€™ll see <code>+</code>, the continuation prompt:<br>
å¦‚æœä½ å¿˜è®°å…³é—­å¼•å·ï¼Œä½ ä¼šçœ‹åˆ° <code>+</code>ï¼Œå³ç»­è¡Œæç¤ºç¬¦ï¼š</p>
<pre><code>&gt; "This is a string without a closing quote
+ 
+ 
+ HELP I'M STUCK IN A STRING</code></pre>
<p>If this happens to you and you canâ€™t figure out which quote to close, press Escape to cancel and try again.<br>
å¦‚æœä½ é‡åˆ°è¿™ç§æƒ…å†µï¼Œå¹¶ä¸”ä¸çŸ¥é“è¯¥å…³é—­å“ªä¸ªå¼•å·ï¼Œè¯·æŒ‰ Escape é”®å–æ¶ˆå¹¶é‡è¯•ã€‚</p>
<section id="escapes" class="level3" data-number="14.2.1"><h3 data-number="14.2.1" class="anchored" data-anchor-id="escapes">
<span class="header-section-number">14.2.1</span> Escapes</h3>
<p>To include a literal single or double quote in a string, you can use <code>\</code> to â€œescapeâ€ it:<br>
è¦åœ¨å­—ç¬¦ä¸²ä¸­åŒ…å«å­—é¢ä¸Šçš„å•å¼•å·æˆ–åŒå¼•å·ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>\</code> æ¥â€œè½¬ä¹‰â€å®ƒï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">double_quote</span> <span class="op">&lt;-</span> <span class="st">"\""</span> <span class="co"># or '"'</span></span>
<span><span class="va">single_quote</span> <span class="op">&lt;-</span> <span class="st">'\''</span> <span class="co"># or "'"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>So if you want to include a literal backslash in your string, youâ€™ll need to escape it: <code>"\\"</code>:<br>
å› æ­¤ï¼Œå¦‚æœä½ æƒ³åœ¨å­—ç¬¦ä¸²ä¸­åŒ…å«ä¸€ä¸ªå­—é¢ä¸Šçš„åæ–œæ ï¼Œä½ éœ€è¦å¯¹å®ƒè¿›è¡Œè½¬ä¹‰ï¼š<code>"\\"</code>ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">backslash</span> <span class="op">&lt;-</span> <span class="st">"\\"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Beware that the printed representation of a string is not the same as the string itself because the printed representation shows the escapes (in other words, when you print a string, you can copy and paste the output to recreate that string). To see the raw contents of the string, use <code><a href="https://stringr.tidyverse.org/reference/str_view.html">str_view()</a></code><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>:<br>
æ³¨æ„ï¼Œå­—ç¬¦ä¸²çš„æ‰“å°è¡¨ç¤ºå½¢å¼ä¸å­—ç¬¦ä¸²æœ¬èº«å¹¶ä¸ç›¸åŒï¼Œå› ä¸ºæ‰“å°è¡¨ç¤ºå½¢å¼ä¼šæ˜¾ç¤ºè½¬ä¹‰å­—ç¬¦ï¼ˆæ¢å¥è¯è¯´ï¼Œå½“ä½ æ‰“å°ä¸€ä¸ªå­—ç¬¦ä¸²æ—¶ï¼Œä½ å¯ä»¥å¤åˆ¶å¹¶ç²˜è´´è¾“å‡ºæ¥é‡æ–°åˆ›å»ºè¯¥å­—ç¬¦ä¸²ï¼‰ã€‚è¦æŸ¥çœ‹å­—ç¬¦ä¸²çš„åŸå§‹å†…å®¹ï¼Œè¯·ä½¿ç”¨ <code><a href="https://stringr.tidyverse.org/reference/str_view.html">str_view()</a></code><sup>1</sup>ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">single_quote</span>, <span class="va">double_quote</span>, <span class="va">backslash</span><span class="op">)</span></span>
<span><span class="va">x</span></span>
<span><span class="co">#&gt; [1] "'"  "\"" "\\"</span></span>
<span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_view.html">str_view</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] â”‚ '</span></span>
<span><span class="co">#&gt; [2] â”‚ "</span></span>
<span><span class="co">#&gt; [3] â”‚ \</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-raw-strings" class="level3" data-number="14.2.2"><h3 data-number="14.2.2" class="anchored" data-anchor-id="sec-raw-strings">
<span class="header-section-number">14.2.2</span> Raw strings</h3>
<p>Creating a string with multiple quotes or backslashes gets confusing quickly. To illustrate the problem, letâ€™s create a string that contains the contents of the code block where we define the <code>double_quote</code> and <code>single_quote</code> variables:<br>
åˆ›å»ºä¸€ä¸ªåŒ…å«å¤šä¸ªå¼•å·æˆ–åæ–œæ çš„å­—ç¬¦ä¸²å¾ˆå¿«å°±ä¼šå˜å¾—æ··ä¹±ã€‚ä¸ºäº†è¯´æ˜è¿™ä¸ªé—®é¢˜ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå®ƒåŒ…å«æˆ‘ä»¬å®šä¹‰ <code>double_quote</code> å’Œ <code>single_quote</code> å˜é‡çš„ä»£ç å—çš„å†…å®¹ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tricky</span> <span class="op">&lt;-</span> <span class="st">"double_quote &lt;- \"\\\"\" # or '\"'</span></span>
<span><span class="st">single_quote &lt;- '\\'' # or \"'\""</span></span>
<span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_view.html">str_view</a></span><span class="op">(</span><span class="va">tricky</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] â”‚ double_quote &lt;- "\"" # or '"'</span></span>
<span><span class="co">#&gt;     â”‚ single_quote &lt;- '\'' # or "'"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Thatâ€™s a lot of backslashes! (This is sometimes called <a href="https://en.wikipedia.org/wiki/Leaning_toothpick_syndrome">leaning toothpick syndrome</a>.) To eliminate the escaping, you can instead use a <strong>raw string</strong><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>:<br>
è¿™é‡Œæœ‰å¤ªå¤šçš„åæ–œæ äº†ï¼ï¼ˆè¿™æœ‰æ—¶è¢«ç§°ä¸ºâ€œ<a href="https://en.wikipedia.org/wiki/Leaning_toothpick_syndrome">æ–œæ ç‰™ç­¾ç»¼åˆç—‡</a>â€ (leaning toothpick syndrome)ï¼‰ã€‚ä¸ºäº†æ¶ˆé™¤è½¬ä¹‰ï¼Œä½ å¯ä»¥æ”¹ç”¨<strong>åŸå§‹å­—ç¬¦ä¸²</strong> (raw string)<sup>2</sup>ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tricky</span> <span class="op">&lt;-</span> <span class="st">r"(double_quote &lt;- "\"" # or '"'</span></span>
<span><span class="st">single_quote &lt;- '\'' # or "'")"</span></span>
<span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_view.html">str_view</a></span><span class="op">(</span><span class="va">tricky</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] â”‚ double_quote &lt;- "\"" # or '"'</span></span>
<span><span class="co">#&gt;     â”‚ single_quote &lt;- '\'' # or "'"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A raw string usually starts with <code>r"(</code> and finishes with <code>)"</code>. But if your string contains <code>)"</code> you can instead use <code>r"[]"</code> or <code>r"{}"</code>, and if thatâ€™s still not enough, you can insert any number of dashes to make the opening and closing pairs unique, e.g., <code>r"--()--"</code>, <code>r"---()---"</code>, etc. Raw strings are flexible enough to handle any text.<br>
åŸå§‹å­—ç¬¦ä¸²é€šå¸¸ä»¥ <code>r"(</code> å¼€å§‹ï¼Œä»¥ <code>)"</code> ç»“æŸã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ çš„å­—ç¬¦ä¸²åŒ…å« <code>)"</code>ï¼Œä½ å¯ä»¥æ”¹ç”¨ <code>r"[]"</code> æˆ– <code>r"{}"</code>ï¼Œå¦‚æœè¿™è¿˜ä¸å¤Ÿï¼Œä½ å¯ä»¥æ’å…¥ä»»æ„æ•°é‡çš„ç ´æŠ˜å·æ¥ä½¿å¼€å§‹å’Œç»“æŸå¯¹å”¯ä¸€ï¼Œä¾‹å¦‚ <code>r"--()--"</code>ã€<code>r"---()---"</code> ç­‰ã€‚åŸå§‹å­—ç¬¦ä¸²è¶³å¤Ÿçµæ´»ï¼Œå¯ä»¥å¤„ç†ä»»ä½•æ–‡æœ¬ã€‚</p>
</section><section id="other-special-characters" class="level3" data-number="14.2.3"><h3 data-number="14.2.3" class="anchored" data-anchor-id="other-special-characters">
<span class="header-section-number">14.2.3</span> Other special characters</h3>
<p>As well as <code>\"</code>, <code>\'</code>, and <code>\\</code>, there are a handful of other special characters that may come in handy. The most common are <code>\n</code>, a new line, and <code>\t</code>, tab. Youâ€™ll also sometimes see strings containing Unicode escapes that start with <code>\u</code> or <code>\U</code>. This is a way of writing non-English characters that work on all systems. You can see the complete list of other special characters in <code><a href="https://rdrr.io/r/base/Quotes.html">?Quotes</a></code>.<br>
é™¤äº† <code>\"</code>ã€<code>\'</code> å’Œ <code>\\</code>ï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–å¯èƒ½æ´¾ä¸Šç”¨åœºçš„ç‰¹æ®Šå­—ç¬¦ã€‚æœ€å¸¸è§çš„æ˜¯ <code>\n</code>ï¼ˆæ¢è¡Œç¬¦ï¼‰å’Œ <code>\t</code>ï¼ˆåˆ¶è¡¨ç¬¦ï¼‰ã€‚ä½ æœ‰æ—¶ä¹Ÿä¼šçœ‹åˆ°åŒ…å«ä»¥ <code>\u</code> æˆ– <code>\U</code> å¼€å¤´çš„ Unicode è½¬ä¹‰åºåˆ—çš„å­—ç¬¦ä¸²ã€‚è¿™æ˜¯ä¸€ç§åœ¨æ‰€æœ‰ç³»ç»Ÿä¸Šéƒ½èƒ½æ­£å¸¸å·¥ä½œçš„éè‹±æ–‡å­—ç¬¦çš„ä¹¦å†™æ–¹å¼ã€‚ä½ å¯ä»¥åœ¨ <code><a href="https://rdrr.io/r/base/Quotes.html">?Quotes</a></code> ä¸­çœ‹åˆ°å…¶ä»–ç‰¹æ®Šå­—ç¬¦çš„å®Œæ•´åˆ—è¡¨ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"one\ntwo"</span>, <span class="st">"one\ttwo"</span>, <span class="st">"\u00b5"</span>, <span class="st">"\U0001f604"</span><span class="op">)</span></span>
<span><span class="va">x</span></span>
<span><span class="co">#&gt; [1] "one\ntwo" "one\ttwo" "Âµ"        "ğŸ˜„"</span></span>
<span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_view.html">str_view</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] â”‚ one</span></span>
<span><span class="co">#&gt;     â”‚ two</span></span>
<span><span class="co">#&gt; [2] â”‚ one{\t}two</span></span>
<span><span class="co">#&gt; [3] â”‚ Âµ</span></span>
<span><span class="co">#&gt; [4] â”‚ ğŸ˜„</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that <code><a href="https://stringr.tidyverse.org/reference/str_view.html">str_view()</a></code> uses curly braces for tabs to make them easier to spot<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. One of the challenges of working with text is that thereâ€™s a variety of ways that white space can end up in the text, so this background helps you recognize that something strange is going on.<br>
è¯·æ³¨æ„ <code><a href="https://stringr.tidyverse.org/reference/str_view.html">str_view()</a></code> å¯¹åˆ¶è¡¨ç¬¦ä½¿ç”¨èŠ±æ‹¬å·ï¼Œä»¥ä¾¿æ›´å®¹æ˜“å‘ç°å®ƒä»¬<sup>3</sup>ã€‚å¤„ç†æ–‡æœ¬çš„æŒ‘æˆ˜ä¹‹ä¸€æ˜¯ï¼Œç©ºç™½å­—ç¬¦ (white space) å¯èƒ½ä»¥å¤šç§æ–¹å¼å‡ºç°åœ¨æ–‡æœ¬ä¸­ï¼Œæ‰€ä»¥è¿™ä¸ªèƒŒæ™¯çŸ¥è¯†å¯ä»¥å¸®åŠ©ä½ è¯†åˆ«å‡ºæ˜¯å¦å‘ç”Ÿäº†å¼‚å¸¸æƒ…å†µã€‚</p>
</section><section id="exercises" class="level3" data-number="14.2.4"><h3 data-number="14.2.4" class="anchored" data-anchor-id="exercises">
<span class="header-section-number">14.2.4</span> Exercises</h3>
<ol type="1">
<li>
<p>Create strings that contain the following values:</p>
<ol type="1">
<li><p><code>He said "That's amazing!"</code></p></li>
<li><p><code>\a\b\c\d</code></p></li>
<li><p><code>\\\\\\</code></p></li>
</ol>
</li>
<li>
<p>Create the string in your R session and print it. What happens to the special â€œ\u00a0â€? How does <code><a href="https://stringr.tidyverse.org/reference/str_view.html">str_view()</a></code> display it? Can you do a little googling to figure out what this special character is?</p>
<p><code>{r}     x &lt;- "This\u00a0is\u00a0tricky"</code></p>
</li>
</ol></section></section><section id="creating-many-strings-from-data" class="level2" data-number="14.3"><h2 data-number="14.3" class="anchored" data-anchor-id="creating-many-strings-from-data">
<span class="header-section-number">14.3</span> Creating many strings from data</h2>
<p>Now that youâ€™ve learned the basics of creating a string or two by â€œhandâ€, weâ€™ll go into the details of creating strings from other strings. This will help you solve the common problem where you have some text you wrote that you want to combine with strings from a data frame. For example, you might combine â€œHelloâ€ with a <code>name</code> variable to create a greeting. Weâ€™ll show you how to do this with <code><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c()</a></code> and <code><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue()</a></code> and how you can use them with <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>. That naturally raises the question of what stringr functions you might use with <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code>, so weâ€™ll finish this section with a discussion of <code><a href="https://stringr.tidyverse.org/reference/str_flatten.html">str_flatten()</a></code>, which is a summary function for strings.<br>
ç°åœ¨ä½ å·²ç»å­¦ä¼šäº†å¦‚ä½•â€œæ‰‹åŠ¨â€åˆ›å»ºä¸€ä¸¤ä¸ªå­—ç¬¦ä¸²çš„åŸºç¡€çŸ¥è¯†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†æ·±å…¥æ¢è®¨å¦‚ä½•ä»å…¶ä»–å­—ç¬¦ä¸²åˆ›å»ºå­—ç¬¦ä¸²ã€‚è¿™å°†å¸®åŠ©ä½ è§£å†³ä¸€ä¸ªå¸¸è§é—®é¢˜ï¼šä½ æœ‰ä¸€äº›è‡ªå·±ç¼–å†™çš„æ–‡æœ¬ï¼Œå¹¶å¸Œæœ›å°†å…¶ä¸æ•°æ®æ¡†ä¸­çš„å­—ç¬¦ä¸²ç»“åˆèµ·æ¥ã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½æƒ³å°† â€œHelloâ€ ä¸ä¸€ä¸ª <code>name</code> å˜é‡ç»“åˆèµ·æ¥åˆ›å»ºä¸€ä¸ªé—®å€™è¯­ã€‚æˆ‘ä»¬å°†å‘ä½ å±•ç¤ºå¦‚ä½•ä½¿ç”¨ <code><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c()</a></code> å’Œ <code><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue()</a></code> æ¥å®ç°è¿™ä¸€ç‚¹ï¼Œä»¥åŠå¦‚ä½•å°†å®ƒä»¬ä¸ <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> ä¸€èµ·ä½¿ç”¨ã€‚è¿™è‡ªç„¶å¼•å‡ºäº†ä¸€ä¸ªé—®é¢˜ï¼šä½ å¯ä»¥å°†å“ªäº› stringr å‡½æ•°ä¸ <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> ä¸€èµ·ä½¿ç”¨ï¼Ÿå› æ­¤ï¼Œæœ¬èŠ‚æœ€åå°†è®¨è®º <code><a href="https://stringr.tidyverse.org/reference/str_flatten.html">str_flatten()</a></code>ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºå­—ç¬¦ä¸²çš„æ±‡æ€»å‡½æ•°ã€‚</p>
<section id="str_c" class="level3" data-number="14.3.1"><h3 data-number="14.3.1" class="anchored" data-anchor-id="str_c">
<span class="header-section-number">14.3.1</span> <code>str_c()</code>
</h3>
<p><code><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c()</a></code> takes any number of vectors as arguments and returns a character vector:<br><code><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c()</a></code> æ¥å—ä»»æ„æ•°é‡çš„å‘é‡ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªå­—ç¬¦å‘é‡ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "xy"</span></span>
<span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "xyz"</span></span>
<span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="st">"Hello "</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"John"</span>, <span class="st">"Susan"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Hello John"  "Hello Susan"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c()</a></code> is very similar to the base <code><a href="https://rdrr.io/r/base/paste.html">paste0()</a></code>, but is designed to be used with <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> by obeying the usual tidyverse rules for recycling and propagating missing values:<br><code><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c()</a></code> ä¸åŸºç¡€å‡½æ•° <code><a href="https://rdrr.io/r/base/paste.html">paste0()</a></code> éå¸¸ç›¸ä¼¼ï¼Œä½†å®ƒéµå¾ª tidyverse é€šå¸¸çš„å›æ”¶è§„åˆ™å’Œç¼ºå¤±å€¼ä¼ æ’­è§„åˆ™ï¼Œå› æ­¤è¢«è®¾è®¡ä¸ºä¸ <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> ä¸€èµ·ä½¿ç”¨ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Flora"</span>, <span class="st">"David"</span>, <span class="st">"Terra"</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>greeting <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="st">"Hi "</span>, <span class="va">name</span>, <span class="st">"!"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4 Ã— 2</span></span>
<span><span class="co">#&gt;   name  greeting </span></span>
<span><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;    </span></span>
<span><span class="co">#&gt; 1 Flora Hi Flora!</span></span>
<span><span class="co">#&gt; 2 David Hi David!</span></span>
<span><span class="co">#&gt; 3 Terra Hi Terra!</span></span>
<span><span class="co">#&gt; 4 &lt;NA&gt;  &lt;NA&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If you want missing values to display in another way, use <code><a href="https://dplyr.tidyverse.org/reference/coalesce.html">coalesce()</a></code> to replace them. Depending on what you want, you might use it either inside or outside of <code><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c()</a></code>:<br>
å¦‚æœä½ æƒ³è®©ç¼ºå¤±å€¼ä»¥å…¶ä»–æ–¹å¼æ˜¾ç¤ºï¼Œå¯ä»¥ä½¿ç”¨ <code><a href="https://dplyr.tidyverse.org/reference/coalesce.html">coalesce()</a></code> æ¥æ›¿æ¢å®ƒä»¬ã€‚æ ¹æ®ä½ çš„éœ€æ±‚ï¼Œä½ å¯ä»¥åœ¨ <code><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c()</a></code> å†…éƒ¨æˆ–å¤–éƒ¨ä½¿ç”¨å®ƒï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    greeting1 <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="st">"Hi "</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/coalesce.html">coalesce</a></span><span class="op">(</span><span class="va">name</span>, <span class="st">"you"</span><span class="op">)</span>, <span class="st">"!"</span><span class="op">)</span>,</span>
<span>    greeting2 <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/coalesce.html">coalesce</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="st">"Hi "</span>, <span class="va">name</span>, <span class="st">"!"</span><span class="op">)</span>, <span class="st">"Hi!"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4 Ã— 3</span></span>
<span><span class="co">#&gt;   name  greeting1 greeting2</span></span>
<span><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;    </span></span>
<span><span class="co">#&gt; 1 Flora Hi Flora! Hi Flora!</span></span>
<span><span class="co">#&gt; 2 David Hi David! Hi David!</span></span>
<span><span class="co">#&gt; 3 Terra Hi Terra! Hi Terra!</span></span>
<span><span class="co">#&gt; 4 &lt;NA&gt;  Hi you!   Hi!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-glue" class="level3" data-number="14.3.2"><h3 data-number="14.3.2" class="anchored" data-anchor-id="sec-glue">
<span class="header-section-number">14.3.2</span> <code>str_glue()</code>
</h3>
<p>If you are mixing many fixed and variable strings with <code><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c()</a></code>, youâ€™ll notice that you type a lot of <code>"</code>s, making it hard to see the overall goal of the code. An alternative approach is provided by the <a href="https://glue.tidyverse.org">glue package</a> via <code><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue()</a></code><a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>. You give it a single string that has a special feature: anything inside <code><a href="https://rdrr.io/r/base/Paren.html">{}</a></code> will be evaluated like itâ€™s outside of the quotes:<br>
å¦‚æœä½ ä½¿ç”¨ <code><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c()</a></code> æ··åˆè®¸å¤šå›ºå®šçš„å’Œå¯å˜çš„å­—ç¬¦ä¸²ï¼Œä½ ä¼šå‘ç°ä½ è¾“å…¥äº†å¤§é‡çš„ <code>"</code>ï¼Œè¿™ä½¿å¾—ä»£ç çš„æ•´ä½“ç›®æ ‡éš¾ä»¥çœ‹æ¸…ã€‚glue åŒ…é€šè¿‡ <code><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue()</a></code><sup>4</sup> æä¾›äº†å¦ä¸€ç§æ–¹æ³•ã€‚ä½ ç»™å®ƒä¸€ä¸ªå…·æœ‰ç‰¹æ®ŠåŠŸèƒ½çš„å•ä¸€å­—ç¬¦ä¸²ï¼šåœ¨ <code><a href="https://rdrr.io/r/base/Paren.html">{}</a></code> å†…çš„ä»»ä½•å†…å®¹éƒ½ä¼šåƒåœ¨å¼•å·ä¹‹å¤–ä¸€æ ·è¢«æ±‚å€¼ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>greeting <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue</a></span><span class="op">(</span><span class="st">"Hi {name}!"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4 Ã— 2</span></span>
<span><span class="co">#&gt;   name  greeting </span></span>
<span><span class="co">#&gt;   &lt;chr&gt; &lt;glue&gt;   </span></span>
<span><span class="co">#&gt; 1 Flora Hi Flora!</span></span>
<span><span class="co">#&gt; 2 David Hi David!</span></span>
<span><span class="co">#&gt; 3 Terra Hi Terra!</span></span>
<span><span class="co">#&gt; 4 &lt;NA&gt;  Hi NA!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As you can see, <code><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue()</a></code> currently converts missing values to the string <code>"NA"</code>, unfortunately making it inconsistent with <code><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c()</a></code>.<br>
æ­£å¦‚ä½ æ‰€è§ï¼Œ<code><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue()</a></code> ç›®å‰å°†ç¼ºå¤±å€¼è½¬æ¢ä¸ºå­—ç¬¦ä¸² <code>"NA"</code>ï¼Œä¸å¹¸çš„æ˜¯ï¼Œè¿™ä½¿å…¶ä¸ <code><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c()</a></code> ä¸ä¸€è‡´ã€‚</p>
<p>You also might wonder what happens if you need to include a regular <code>{</code> or <code>}</code> in your string. Youâ€™re on the right track if you guess youâ€™ll need to escape it somehow. The trick is that glue uses a slightly different escaping technique: instead of prefixing with special character like <code>\</code>, you double up the special characters:<br>
ä½ å¯èƒ½è¿˜ä¼šæƒ³ï¼Œå¦‚æœéœ€è¦åœ¨å­—ç¬¦ä¸²ä¸­åŒ…å«å¸¸è§„çš„ <code>{</code> æˆ– <code>}</code>ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆã€‚å¦‚æœä½ çŒœåˆ°éœ€è¦ä»¥æŸç§æ–¹å¼è½¬ä¹‰å®ƒï¼Œé‚£ä½ å°±çŒœå¯¹äº†ã€‚è¯€çªæ˜¯ glue ä½¿ç”¨ä¸€ç§ç¨æœ‰ä¸åŒçš„è½¬ä¹‰æŠ€æœ¯ï¼šä¸æ˜¯åƒ <code>\</code> é‚£æ ·ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦ä½œä¸ºå‰ç¼€ï¼Œè€Œæ˜¯å°†ç‰¹æ®Šå­—ç¬¦åŠ å€ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>greeting <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue</a></span><span class="op">(</span><span class="st">"{{Hi {name}!}}"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4 Ã— 2</span></span>
<span><span class="co">#&gt;   name  greeting   </span></span>
<span><span class="co">#&gt;   &lt;chr&gt; &lt;glue&gt;     </span></span>
<span><span class="co">#&gt; 1 Flora {Hi Flora!}</span></span>
<span><span class="co">#&gt; 2 David {Hi David!}</span></span>
<span><span class="co">#&gt; 3 Terra {Hi Terra!}</span></span>
<span><span class="co">#&gt; 4 &lt;NA&gt;  {Hi NA!}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="str_flatten" class="level3" data-number="14.3.3"><h3 data-number="14.3.3" class="anchored" data-anchor-id="str_flatten">
<span class="header-section-number">14.3.3</span> <code>str_flatten()</code>
</h3>
<p><code><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c()</a></code> and <code><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue()</a></code> work well with <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> because their output is the same length as their inputs. What if you want a function that works well with <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code>, i.e.&nbsp;something that always returns a single string? Thatâ€™s the job of <code><a href="https://stringr.tidyverse.org/reference/str_flatten.html">str_flatten()</a></code><a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>: it takes a character vector and combines each element of the vector into a single string:<br><code><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c()</a></code> å’Œ <code><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue()</a></code> ä¸ <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> é…åˆå¾—å¾ˆå¥½ï¼Œå› ä¸ºå®ƒä»¬çš„è¾“å‡ºé•¿åº¦ä¸è¾“å…¥é•¿åº¦ç›¸åŒã€‚å¦‚æœä½ æƒ³è¦ä¸€ä¸ªèƒ½ä¸ <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> å¾ˆå¥½åœ°é…åˆä½¿ç”¨çš„å‡½æ•°ï¼Œå³ä¸€ä¸ªæ€»æ˜¯è¿”å›å•ä¸ªå­—ç¬¦ä¸²çš„å‡½æ•°ï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿè¿™å°±æ˜¯ <code><a href="https://stringr.tidyverse.org/reference/str_flatten.html">str_flatten()</a></code><sup>5</sup> çš„å·¥ä½œï¼šå®ƒæ¥å—ä¸€ä¸ªå­—ç¬¦å‘é‡ï¼Œå¹¶å°†å‘é‡çš„æ¯ä¸ªå…ƒç´ åˆå¹¶æˆä¸€ä¸ªå•ä¸€çš„å­—ç¬¦ä¸²ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_flatten.html">str_flatten</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "xyz"</span></span>
<span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_flatten.html">str_flatten</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span><span class="op">)</span>, <span class="st">", "</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "x, y, z"</span></span>
<span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_flatten.html">str_flatten</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span><span class="op">)</span>, <span class="st">", "</span>, last <span class="op">=</span> <span class="st">", and "</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "x, y, and z"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This makes it work well with <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code>:<br>
è¿™ä½¿å¾—å®ƒèƒ½ä¸ <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> å¾ˆå¥½åœ°é…åˆä½¿ç”¨ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span> <span class="va">name</span>, <span class="op">~</span> <span class="va">fruit</span>,</span>
<span>  <span class="st">"Carmen"</span>, <span class="st">"banana"</span>,</span>
<span>  <span class="st">"Carmen"</span>, <span class="st">"apple"</span>,</span>
<span>  <span class="st">"Marvin"</span>, <span class="st">"nectarine"</span>,</span>
<span>  <span class="st">"Terence"</span>, <span class="st">"cantaloupe"</span>,</span>
<span>  <span class="st">"Terence"</span>, <span class="st">"papaya"</span>,</span>
<span>  <span class="st">"Terence"</span>, <span class="st">"mandarin"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>fruits <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_flatten.html">str_flatten</a></span><span class="op">(</span><span class="va">fruit</span>, <span class="st">", "</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 Ã— 2</span></span>
<span><span class="co">#&gt;   name    fruits                      </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;                       </span></span>
<span><span class="co">#&gt; 1 Carmen  banana, apple               </span></span>
<span><span class="co">#&gt; 2 Marvin  nectarine                   </span></span>
<span><span class="co">#&gt; 3 Terence cantaloupe, papaya, mandarin</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="exercises-1" class="level3" data-number="14.3.4"><h3 data-number="14.3.4" class="anchored" data-anchor-id="exercises-1">
<span class="header-section-number">14.3.4</span> Exercises</h3>
<ol type="1">
<li>
<p>Compare and contrast the results of <code><a href="https://rdrr.io/r/base/paste.html">paste0()</a></code> with <code><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c()</a></code> for the following inputs:</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="st">"hi "</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</li>
<li><p>Whatâ€™s the difference between <code><a href="https://rdrr.io/r/base/paste.html">paste()</a></code> and <code><a href="https://rdrr.io/r/base/paste.html">paste0()</a></code>? How can you recreate the equivalent of <code><a href="https://rdrr.io/r/base/paste.html">paste()</a></code> with <code><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c()</a></code>?</p></li>
<li>
<p>Convert the following expressions from <code><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c()</a></code> to <code><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue()</a></code> or vice versa:</p>
<ol type="a">
<li><p><code>str_c("The price of ", food, " is ", price)</code></p></li>
<li><p><code>str_glue("I'm {age} years old and live in {country}")</code></p></li>
<li><p><code>str_c("\\section{", title, "}")</code></p></li>
</ol>
</li>
</ol></section></section><section id="extracting-data-from-strings" class="level2" data-number="14.4"><h2 data-number="14.4" class="anchored" data-anchor-id="extracting-data-from-strings">
<span class="header-section-number">14.4</span> Extracting data from strings</h2>
<p>Itâ€™s very common for multiple variables to be crammed together into a single string. In this section, youâ€™ll learn how to use four tidyr functions to extract them:<br>
å°†å¤šä¸ªå˜é‡å¡è¿›ä¸€ä¸ªå­—ç¬¦ä¸²é‡Œæ˜¯éå¸¸å¸¸è§çš„ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œä½ å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨å››ä¸ª tidyr å‡½æ•°æ¥æå–å®ƒä»¬ï¼š</p>
<ul>
<li><code>df |&gt; separate_longer_delim(col, delim)</code></li>
<li><code>df |&gt; separate_longer_position(col, width)</code></li>
<li><code>df |&gt; separate_wider_delim(col, delim, names)</code></li>
<li><code>df |&gt; separate_wider_position(col, widths)</code></li>
</ul>
<p>If you look closely, you can see thereâ€™s a common pattern here: <code>separate_</code>, then <code>longer</code> or <code>wider</code>, then <code>_</code>, then by <code>delim</code> or <code>position</code>. Thatâ€™s because these four functions are composed of two simpler primitives:<br>
å¦‚æœä½ ä»”ç»†è§‚å¯Ÿï¼Œä½ ä¼šå‘ç°è¿™é‡Œæœ‰ä¸€ä¸ªå…±åŒçš„æ¨¡å¼ï¼š<code>separate_</code>ï¼Œç„¶åæ˜¯ <code>longer</code> æˆ– <code>wider</code>ï¼Œç„¶åæ˜¯ <code>_</code>ï¼Œå†ç„¶åæ˜¯ <code>delim</code> æˆ– <code>position</code>ã€‚è¿™æ˜¯å› ä¸ºè¿™å››ä¸ªå‡½æ•°æ˜¯ç”±ä¸¤ä¸ªæ›´ç®€å•çš„åŸè¯­ç»„æˆçš„ï¼š</p>
<ul>
<li><p>Just like with <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer()</a></code> and <code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider()</a></code>, <code>_longer</code> functions make the input data frame longer by creating new rows and <code>_wider</code> functions make the input data frame wider by generating new columns.<br>
å°±åƒ <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer()</a></code> å’Œ <code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider()</a></code> ä¸€æ ·ï¼Œ<code>_longer</code> å‡½æ•°é€šè¿‡åˆ›å»ºæ–°è¡Œæ¥ä½¿è¾“å…¥æ•°æ®æ¡†å˜é•¿ï¼Œè€Œ <code>_wider</code> å‡½æ•°é€šè¿‡ç”Ÿæˆæ–°åˆ—æ¥ä½¿è¾“å…¥æ•°æ®æ¡†å˜å®½ã€‚</p></li>
<li><p><code>delim</code> splits up a string with a delimiter like <code>", "</code> or <code>" "</code>; <code>position</code> splits at specified widths, like <code>c(3, 5, 2)</code>.<br><code>delim</code> ä½¿ç”¨åƒ <code>", "</code> æˆ– <code>" "</code> è¿™æ ·çš„åˆ†éš”ç¬¦ (delimiter) æ¥åˆ†å‰²å­—ç¬¦ä¸²ï¼›<code>position</code> åˆ™åœ¨æŒ‡å®šçš„å®½åº¦å¤„è¿›è¡Œåˆ†å‰²ï¼Œä¾‹å¦‚ <code>c(3, 5, 2)</code>ã€‚</p></li>
</ul>
<p>Weâ€™ll return to the last member of this family, <code><a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html">separate_wider_regex()</a></code>, in <a href="regexps.html" class="quarto-xref"><span>Chapter 15</span></a>. Itâ€™s the most flexible of the <code>wider</code> functions, but you need to know something about regular expressions before you can use it.<br>
æˆ‘ä»¬å°†åœ¨ <a href="regexps.html" class="quarto-xref"><span>Chapter 15</span></a> ä¸­å›åˆ°è¿™ä¸ªå®¶æ—çš„æœ€åä¸€ä¸ªæˆå‘˜ <code><a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html">separate_wider_regex()</a></code>ã€‚å®ƒæ˜¯ <code>wider</code> å‡½æ•°ä¸­æœ€çµæ´»çš„ä¸€ä¸ªï¼Œä½†åœ¨ä½¿ç”¨å®ƒä¹‹å‰ï¼Œä½ éœ€è¦å¯¹æ­£åˆ™è¡¨è¾¾å¼æœ‰æ‰€äº†è§£ã€‚</p>
<p>The following two sections will give you the basic idea behind these separate functions, first separating into rows (which is a little simpler) and then separating into columns. Weâ€™ll finish off by discussing the tools that the <code>wider</code> functions give you to diagnose problems.<br>
æ¥ä¸‹æ¥çš„ä¸¤èŠ‚å°†ä¸ºä½ ä»‹ç»è¿™äº› separate å‡½æ•°èƒŒåçš„åŸºæœ¬æ€æƒ³ï¼Œé¦–å…ˆæ˜¯åˆ†æ‹†åˆ°è¡Œï¼ˆè¿™ç¨å¾®ç®€å•ä¸€äº›ï¼‰ï¼Œç„¶åæ˜¯åˆ†æ‹†åˆ°åˆ—ã€‚æœ€åï¼Œæˆ‘ä»¬å°†è®¨è®º <code>wider</code> å‡½æ•°æä¾›çš„ç”¨äºè¯Šæ–­é—®é¢˜çš„å·¥å…·ã€‚</p>
<section id="separating-into-rows" class="level3" data-number="14.4.1"><h3 data-number="14.4.1" class="anchored" data-anchor-id="separating-into-rows">
<span class="header-section-number">14.4.1</span> Separating into rows</h3>
<p>Separating a string into rows tends to be most useful when the number of components varies from row to row. The most common case is requiring <code><a href="https://tidyr.tidyverse.org/reference/separate_longer_delim.html">separate_longer_delim()</a></code> to split based on a delimiter:<br>
å½“ç»„ä»¶æ•°é‡å› è¡Œè€Œå¼‚æ—¶ï¼Œå°†å­—ç¬¦ä¸²åˆ†æ‹†åˆ°è¡Œé€šå¸¸æœ€æœ‰ç”¨ã€‚æœ€å¸¸è§çš„æƒ…å†µæ˜¯éœ€è¦ <code><a href="https://tidyr.tidyverse.org/reference/separate_longer_delim.html">separate_longer_delim()</a></code> åŸºäºåˆ†éš”ç¬¦è¿›è¡Œåˆ†å‰²ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a,b,c"</span>, <span class="st">"d,e"</span>, <span class="st">"f"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df1</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate_longer_delim.html">separate_longer_delim</a></span><span class="op">(</span><span class="va">x</span>, delim <span class="op">=</span> <span class="st">","</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 Ã— 1</span></span>
<span><span class="co">#&gt;   x    </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 a    </span></span>
<span><span class="co">#&gt; 2 b    </span></span>
<span><span class="co">#&gt; 3 c    </span></span>
<span><span class="co">#&gt; 4 d    </span></span>
<span><span class="co">#&gt; 5 e    </span></span>
<span><span class="co">#&gt; 6 f</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Itâ€™s rarer to see <code><a href="https://tidyr.tidyverse.org/reference/separate_longer_delim.html">separate_longer_position()</a></code> in the wild, but some older datasets do use a very compact format where each character is used to record a value:<br>
åœ¨å®é™…åº”ç”¨ä¸­å¾ˆå°‘è§åˆ° <code><a href="https://tidyr.tidyverse.org/reference/separate_longer_delim.html">separate_longer_position()</a></code>ï¼Œä½†ä¸€äº›è¾ƒæ—§çš„æ•°æ®é›†ç¡®å®ä¼šä½¿ç”¨ä¸€ç§éå¸¸ç´§å‡‘çš„æ ¼å¼ï¼Œå…¶ä¸­æ¯ä¸ªå­—ç¬¦éƒ½ç”¨äºè®°å½•ä¸€ä¸ªå€¼ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1211"</span>, <span class="st">"131"</span>, <span class="st">"21"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df2</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate_longer_delim.html">separate_longer_position</a></span><span class="op">(</span><span class="va">x</span>, width <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 9 Ã— 1</span></span>
<span><span class="co">#&gt;   x    </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 1    </span></span>
<span><span class="co">#&gt; 2 2    </span></span>
<span><span class="co">#&gt; 3 1    </span></span>
<span><span class="co">#&gt; 4 1    </span></span>
<span><span class="co">#&gt; 5 1    </span></span>
<span><span class="co">#&gt; 6 3    </span></span>
<span><span class="co">#&gt; # â„¹ 3 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-string-columns" class="level3" data-number="14.4.2"><h3 data-number="14.4.2" class="anchored" data-anchor-id="sec-string-columns">
<span class="header-section-number">14.4.2</span> Separating into columns</h3>
<p>Separating a string into columns tends to be most useful when there are a fixed number of components in each string, and you want to spread them into columns. They are slightly more complicated than their <code>longer</code> equivalents because you need to name the columns. For example, in this following dataset, <code>x</code> is made up of a code, an edition number, and a year, separated by <code>"."</code>. To use <code><a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html">separate_wider_delim()</a></code>, we supply the delimiter and the names in two arguments:<br>
å½“æ¯ä¸ªå­—ç¬¦ä¸²ä¸­éƒ½æœ‰å›ºå®šæ•°é‡çš„ç»„ä»¶ï¼Œå¹¶ä¸”ä½ æƒ³å°†å®ƒä»¬åˆ†æ•£åˆ°åˆ—ä¸­æ—¶ï¼Œå°†å­—ç¬¦ä¸²åˆ†æ‹†åˆ°åˆ—é€šå¸¸æœ€æœ‰ç”¨ã€‚å®ƒä»¬æ¯” <code>longer</code> å¯¹åº”çš„å‡½æ•°ç¨å¾®å¤æ‚ä¸€äº›ï¼Œå› ä¸ºä½ éœ€è¦ä¸ºåˆ—å‘½åã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸‹é¢çš„æ•°æ®é›†ä¸­ï¼Œ<code>x</code> ç”±ä¸€ä¸ªä»£ç ã€ä¸€ä¸ªç‰ˆæœ¬å·å’Œä¸€ä¸ªå¹´ä»½ç»„æˆï¼Œç”¨ <code>"."</code> åˆ†éš”ã€‚è¦ä½¿ç”¨ <code><a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html">separate_wider_delim()</a></code>ï¼Œæˆ‘ä»¬åœ¨ä¸¤ä¸ªå‚æ•°ä¸­æä¾›åˆ†éš”ç¬¦å’Œåç§°ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a10.1.2022"</span>, <span class="st">"b10.2.2011"</span>, <span class="st">"e15.1.2015"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df3</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html">separate_wider_delim</a></span><span class="op">(</span></span>
<span>    <span class="va">x</span>,</span>
<span>    delim <span class="op">=</span> <span class="st">"."</span>,</span>
<span>    names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"code"</span>, <span class="st">"edition"</span>, <span class="st">"year"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 Ã— 3</span></span>
<span><span class="co">#&gt;   code  edition year </span></span>
<span><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 a10   1       2022 </span></span>
<span><span class="co">#&gt; 2 b10   2       2011 </span></span>
<span><span class="co">#&gt; 3 e15   1       2015</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If a specific piece is not useful you can use an <code>NA</code> name to omit it from the results:<br>
å¦‚æœæŸä¸ªç‰¹å®šçš„éƒ¨åˆ†æ²¡æœ‰ç”¨ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>NA</code> åç§°å°†å…¶ä»ç»“æœä¸­çœç•¥ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df3</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html">separate_wider_delim</a></span><span class="op">(</span></span>
<span>    <span class="va">x</span>,</span>
<span>    delim <span class="op">=</span> <span class="st">"."</span>,</span>
<span>    names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"code"</span>, <span class="cn">NA</span>, <span class="st">"year"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 Ã— 2</span></span>
<span><span class="co">#&gt;   code  year </span></span>
<span><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 a10   2022 </span></span>
<span><span class="co">#&gt; 2 b10   2011 </span></span>
<span><span class="co">#&gt; 3 e15   2015</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code><a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html">separate_wider_position()</a></code> works a little differently because you typically want to specify the width of each column. So you give it a named integer vector, where the name gives the name of the new column, and the value is the number of characters it occupies. You can omit values from the output by not naming them:<br><code><a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html">separate_wider_position()</a></code> çš„å·¥ä½œæ–¹å¼ç¨æœ‰ä¸åŒï¼Œå› ä¸ºä½ é€šå¸¸éœ€è¦æŒ‡å®šæ¯åˆ—çš„å®½åº¦ã€‚å› æ­¤ï¼Œä½ éœ€è¦ç»™å®ƒä¸€ä¸ªå‘½åçš„æ•´æ•°å‘é‡ï¼Œå…¶ä¸­åç§°ç»™å‡ºæ–°åˆ—çš„åç§°ï¼Œå€¼æ˜¯å®ƒå ç”¨çš„å­—ç¬¦æ•°ã€‚ä½ å¯ä»¥é€šè¿‡ä¸å‘½åæ¥ä»è¾“å‡ºä¸­çœç•¥å€¼ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"202215TX"</span>, <span class="st">"202122LA"</span>, <span class="st">"202325CA"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">df4</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html">separate_wider_position</a></span><span class="op">(</span></span>
<span>    <span class="va">x</span>,</span>
<span>    widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">4</span>, age <span class="op">=</span> <span class="fl">2</span>, state <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 Ã— 3</span></span>
<span><span class="co">#&gt;   year  age   state</span></span>
<span><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 2022  15    TX   </span></span>
<span><span class="co">#&gt; 2 2021  22    LA   </span></span>
<span><span class="co">#&gt; 3 2023  25    CA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="diagnosing-widening-problems" class="level3" data-number="14.4.3"><h3 data-number="14.4.3" class="anchored" data-anchor-id="diagnosing-widening-problems">
<span class="header-section-number">14.4.3</span> Diagnosing widening problems</h3>
<p><code><a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html">separate_wider_delim()</a></code><a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> requires a fixed and known set of columns. What happens if some of the rows donâ€™t have the expected number of pieces? There are two possible problems, too few or too many pieces, so <code><a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html">separate_wider_delim()</a></code> provides two arguments to help: <code>too_few</code> and <code>too_many</code>. Letâ€™s first look at the <code>too_few</code> case with the following sample dataset:<br><code><a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html">separate_wider_delim()</a></code><sup>6</sup> éœ€è¦ä¸€ä¸ªå›ºå®šä¸”å·²çŸ¥çš„åˆ—é›†åˆã€‚å¦‚æœæŸäº›è¡Œæ²¡æœ‰é¢„æœŸçš„ç‰‡æ®µæ•°é‡ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿå¯èƒ½å­˜åœ¨ä¸¤ç§é—®é¢˜ï¼Œç‰‡æ®µå¤ªå°‘æˆ–å¤ªå¤šï¼Œå› æ­¤ <code><a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html">separate_wider_delim()</a></code> æä¾›äº†ä¸¤ä¸ªå‚æ•°æ¥å¸®åŠ©è§£å†³ï¼š<code>too_few</code> å’Œ <code>too_many</code>ã€‚è®©æˆ‘ä»¬é¦–å…ˆç”¨ä»¥ä¸‹ç¤ºä¾‹æ•°æ®é›†çœ‹ä¸€ä¸‹ <code>too_few</code> çš„æƒ…å†µï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1-1-1"</span>, <span class="st">"1-1-2"</span>, <span class="st">"1-3"</span>, <span class="st">"1-3-2"</span>, <span class="st">"1"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html">separate_wider_delim</a></span><span class="op">(</span></span>
<span>    <span class="va">x</span>,</span>
<span>    delim <span class="op">=</span> <span class="st">"-"</span>,</span>
<span>    names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Error in `separate_wider_delim()`:</span></span>
<span><span class="co">#&gt; ! Expected 3 pieces in each element of `x`.</span></span>
<span><span class="co">#&gt; ! 2 values were too short.</span></span>
<span><span class="co">#&gt; â„¹ Use `too_few = "debug"` to diagnose the problem.</span></span>
<span><span class="co">#&gt; â„¹ Use `too_few = "align_start"/"align_end"` to silence this message.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Youâ€™ll notice that we get an error, but the error gives us some suggestions on how you might proceed. Letâ€™s start by debugging the problem:<br>
ä½ ä¼šæ³¨æ„åˆ°æˆ‘ä»¬æ”¶åˆ°äº†ä¸€ä¸ªé”™è¯¯ï¼Œä½†è¿™ä¸ªé”™è¯¯ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€äº›å…³äºå¦‚ä½•ç»§ç»­æ“ä½œçš„å»ºè®®ã€‚è®©æˆ‘ä»¬ä»è°ƒè¯•é—®é¢˜å¼€å§‹ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">debug</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html">separate_wider_delim</a></span><span class="op">(</span></span>
<span>    <span class="va">x</span>,</span>
<span>    delim <span class="op">=</span> <span class="st">"-"</span>,</span>
<span>    names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span><span class="op">)</span>,</span>
<span>    too_few <span class="op">=</span> <span class="st">"debug"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Debug mode activated: adding variables `x_ok`, `x_pieces`, and</span></span>
<span><span class="co">#&gt; `x_remainder`.</span></span>
<span><span class="va">debug</span></span>
<span><span class="co">#&gt; # A tibble: 5 Ã— 6</span></span>
<span><span class="co">#&gt;   x     y     z     x_ok  x_pieces x_remainder</span></span>
<span><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;lgl&gt;    &lt;int&gt; &lt;chr&gt;      </span></span>
<span><span class="co">#&gt; 1 1-1-1 1     1     TRUE         3 ""         </span></span>
<span><span class="co">#&gt; 2 1-1-2 1     2     TRUE         3 ""         </span></span>
<span><span class="co">#&gt; 3 1-3   3     &lt;NA&gt;  FALSE        2 ""         </span></span>
<span><span class="co">#&gt; 4 1-3-2 3     2     TRUE         3 ""         </span></span>
<span><span class="co">#&gt; 5 1     &lt;NA&gt;  &lt;NA&gt;  FALSE        1 ""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When you use the debug mode, you get three extra columns added to the output: <code>x_ok</code>, <code>x_pieces</code>, and <code>x_remainder</code> (if you separate a variable with a different name, youâ€™ll get a different prefix). Here, <code>x_ok</code> lets you quickly find the inputs that failed:<br>
å½“ä½ ä½¿ç”¨è°ƒè¯•æ¨¡å¼æ—¶ï¼Œè¾“å‡ºä¸­ä¼šæ·»åŠ ä¸‰ä¸ªé¢å¤–çš„åˆ—ï¼š<code>x_ok</code>ã€<code>x_pieces</code> å’Œ <code>x_remainder</code>ï¼ˆå¦‚æœä½ åˆ†å‰²ä¸€ä¸ªä¸åŒåç§°çš„å˜é‡ï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ªä¸åŒçš„å‰ç¼€ï¼‰ã€‚åœ¨è¿™é‡Œï¼Œ<code>x_ok</code> å¯ä»¥è®©ä½ å¿«é€Ÿæ‰¾åˆ°å¤±è´¥çš„è¾“å…¥ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">debug</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">x_ok</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 Ã— 6</span></span>
<span><span class="co">#&gt;   x     y     z     x_ok  x_pieces x_remainder</span></span>
<span><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;lgl&gt;    &lt;int&gt; &lt;chr&gt;      </span></span>
<span><span class="co">#&gt; 1 1-3   3     &lt;NA&gt;  FALSE        2 ""         </span></span>
<span><span class="co">#&gt; 2 1     &lt;NA&gt;  &lt;NA&gt;  FALSE        1 ""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>x_pieces</code> tells us how many pieces were found, compared to the expected 3 (the length of <code>names</code>). <code>x_remainder</code> isnâ€™t useful when there are too few pieces, but weâ€™ll see it again shortly.<br><code>x_pieces</code> å‘Šè¯‰æˆ‘ä»¬æ‰¾åˆ°äº†å¤šå°‘ä¸ªç‰‡æ®µï¼Œä¸é¢„æœŸçš„ 3 ä¸ªï¼ˆ<code>names</code> çš„é•¿åº¦ï¼‰ç›¸æ¯”ã€‚å½“ç‰‡æ®µå¤ªå°‘æ—¶ï¼Œ<code>x_remainder</code> æ²¡æœ‰ç”¨ï¼Œä½†æˆ‘ä»¬å¾ˆå¿«ä¼šå†æ¬¡çœ‹åˆ°å®ƒã€‚</p>
<p>Sometimes looking at this debugging information will reveal a problem with your delimiter strategy or suggest that you need to do more preprocessing before separating. In that case, fix the problem upstream and make sure to remove <code>too_few = "debug"</code> to ensure that new problems become errors.<br>
æœ‰æ—¶æŸ¥çœ‹è¿™äº›è°ƒè¯•ä¿¡æ¯ä¼šæ­ç¤ºä½ çš„åˆ†éš”ç¬¦ç­–ç•¥å­˜åœ¨é—®é¢˜ï¼Œæˆ–è€…å»ºè®®ä½ åœ¨åˆ†å‰²ä¹‹å‰éœ€è¦è¿›è¡Œæ›´å¤šçš„é¢„å¤„ç†ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯·ä¿®å¤ä¸Šæ¸¸çš„é—®é¢˜ï¼Œå¹¶ç¡®ä¿åˆ é™¤ <code>too_few = "debug"</code> ä»¥ç¡®ä¿æ–°é—®é¢˜ä¼šæˆä¸ºé”™è¯¯ã€‚</p>
<p>In other cases, you may want to fill in the missing pieces with <code>NA</code>s and move on. Thatâ€™s the job of <code>too_few = "align_start"</code> and <code>too_few = "align_end"</code> which allow you to control where the <code>NA</code>s should go:<br>
åœ¨å…¶ä»–æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½å¸Œæœ›ç”¨ <code>NA</code> å¡«å……ç¼ºå¤±çš„ç‰‡æ®µç„¶åç»§ç»­ã€‚è¿™æ˜¯ <code>too_few = "align_start"</code> å’Œ <code>too_few = "align_end"</code> çš„å·¥ä½œï¼Œå®ƒä»¬å…è®¸ä½ æ§åˆ¶ <code>NA</code> åº”è¯¥æ”¾åœ¨å“ªé‡Œï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html">separate_wider_delim</a></span><span class="op">(</span></span>
<span>    <span class="va">x</span>,</span>
<span>    delim <span class="op">=</span> <span class="st">"-"</span>,</span>
<span>    names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span><span class="op">)</span>,</span>
<span>    too_few <span class="op">=</span> <span class="st">"align_start"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 5 Ã— 3</span></span>
<span><span class="co">#&gt;   x     y     z    </span></span>
<span><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 1     1     1    </span></span>
<span><span class="co">#&gt; 2 1     1     2    </span></span>
<span><span class="co">#&gt; 3 1     3     &lt;NA&gt; </span></span>
<span><span class="co">#&gt; 4 1     3     2    </span></span>
<span><span class="co">#&gt; 5 1     &lt;NA&gt;  &lt;NA&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The same principles apply if you have too many pieces:<br>
å¦‚æœä½ æœ‰å¤ªå¤šç‰‡æ®µï¼ŒåŒæ ·çš„åŸåˆ™ä¹Ÿé€‚ç”¨ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1-1-1"</span>, <span class="st">"1-1-2"</span>, <span class="st">"1-3-5-6"</span>, <span class="st">"1-3-2"</span>, <span class="st">"1-3-5-7-9"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html">separate_wider_delim</a></span><span class="op">(</span></span>
<span>    <span class="va">x</span>,</span>
<span>    delim <span class="op">=</span> <span class="st">"-"</span>,</span>
<span>    names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Error in `separate_wider_delim()`:</span></span>
<span><span class="co">#&gt; ! Expected 3 pieces in each element of `x`.</span></span>
<span><span class="co">#&gt; ! 2 values were too long.</span></span>
<span><span class="co">#&gt; â„¹ Use `too_many = "debug"` to diagnose the problem.</span></span>
<span><span class="co">#&gt; â„¹ Use `too_many = "drop"/"merge"` to silence this message.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>But now, when we debug the result, you can see the purpose of <code>x_remainder</code>:<br>
ä½†æ˜¯ç°åœ¨ï¼Œå½“æˆ‘ä»¬è°ƒè¯•ç»“æœæ—¶ï¼Œä½ å¯ä»¥çœ‹åˆ° <code>x_remainder</code> çš„ç”¨é€”ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">debug</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html">separate_wider_delim</a></span><span class="op">(</span></span>
<span>    <span class="va">x</span>,</span>
<span>    delim <span class="op">=</span> <span class="st">"-"</span>,</span>
<span>    names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span><span class="op">)</span>,</span>
<span>    too_many <span class="op">=</span> <span class="st">"debug"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Debug mode activated: adding variables `x_ok`, `x_pieces`, and</span></span>
<span><span class="co">#&gt; `x_remainder`.</span></span>
<span><span class="va">debug</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">x_ok</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 Ã— 6</span></span>
<span><span class="co">#&gt;   x         y     z     x_ok  x_pieces x_remainder</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;lgl&gt;    &lt;int&gt; &lt;chr&gt;      </span></span>
<span><span class="co">#&gt; 1 1-3-5-6   3     5     FALSE        4 -6         </span></span>
<span><span class="co">#&gt; 2 1-3-5-7-9 3     5     FALSE        5 -7-9</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You have a slightly different set of options for handling too many pieces: you can either silently â€œdropâ€ any additional pieces or â€œmergeâ€ them all into the final column:<br>
å¯¹äºå¤„ç†è¿‡å¤šç‰‡æ®µï¼Œä½ æœ‰ä¸€å¥—ç¨å¾®ä¸åŒçš„é€‰é¡¹ï¼šä½ å¯ä»¥é»˜é»˜åœ°â€œä¸¢å¼ƒâ€(drop) ä»»ä½•é¢å¤–çš„ç‰‡æ®µï¼Œæˆ–è€…å°†å®ƒä»¬å…¨éƒ¨â€œåˆå¹¶â€(merge) åˆ°æœ€åä¸€åˆ—ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html">separate_wider_delim</a></span><span class="op">(</span></span>
<span>    <span class="va">x</span>,</span>
<span>    delim <span class="op">=</span> <span class="st">"-"</span>,</span>
<span>    names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span><span class="op">)</span>,</span>
<span>    too_many <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 5 Ã— 3</span></span>
<span><span class="co">#&gt;   x     y     z    </span></span>
<span><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 1     1     1    </span></span>
<span><span class="co">#&gt; 2 1     1     2    </span></span>
<span><span class="co">#&gt; 3 1     3     5    </span></span>
<span><span class="co">#&gt; 4 1     3     2    </span></span>
<span><span class="co">#&gt; 5 1     3     5</span></span>
<span></span>
<span></span>
<span><span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html">separate_wider_delim</a></span><span class="op">(</span></span>
<span>    <span class="va">x</span>,</span>
<span>    delim <span class="op">=</span> <span class="st">"-"</span>,</span>
<span>    names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span><span class="op">)</span>,</span>
<span>    too_many <span class="op">=</span> <span class="st">"merge"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 5 Ã— 3</span></span>
<span><span class="co">#&gt;   x     y     z    </span></span>
<span><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 1     1     1    </span></span>
<span><span class="co">#&gt; 2 1     1     2    </span></span>
<span><span class="co">#&gt; 3 1     3     5-6  </span></span>
<span><span class="co">#&gt; 4 1     3     2    </span></span>
<span><span class="co">#&gt; 5 1     3     5-7-9</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="letters" class="level2" data-number="14.5"><h2 data-number="14.5" class="anchored" data-anchor-id="letters">
<span class="header-section-number">14.5</span> Letters</h2>
<p>In this section, weâ€™ll introduce you to functions that allow you to work with the individual letters within a string. Youâ€™ll learn how to find the length of a string, extract substrings, and handle long strings in plots and tables.<br>
åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†å‘ä½ ä»‹ç»ä¸€äº›å¯ä»¥å¤„ç†å­—ç¬¦ä¸²ä¸­å•ä¸ªå­—æ¯çš„å‡½æ•°ã€‚ä½ å°†å­¦ä¹ å¦‚ä½•æŸ¥æ‰¾å­—ç¬¦ä¸²çš„é•¿åº¦ã€æå–å­å­—ç¬¦ä¸²ä»¥åŠåœ¨å›¾è¡¨å’Œè¡¨æ ¼ä¸­å¤„ç†é•¿å­—ç¬¦ä¸²ã€‚</p>
<section id="length" class="level3" data-number="14.5.1"><h3 data-number="14.5.1" class="anchored" data-anchor-id="length">
<span class="header-section-number">14.5.1</span> Length</h3>
<p><code><a href="https://stringr.tidyverse.org/reference/str_length.html">str_length()</a></code> tells you the number of letters in the string:<br><code><a href="https://stringr.tidyverse.org/reference/str_length.html">str_length()</a></code> ä¼šå‘Šè¯‰ä½ å­—ç¬¦ä¸²ä¸­çš„å­—æ¯æ•°é‡ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_length.html">str_length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"R for data science"</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  1 18 NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You could use this with <code><a href="https://dplyr.tidyverse.org/reference/count.html">count()</a></code> to find the distribution of lengths of US babynames and then with <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> to look at the longest names, which happen to have 15 letters<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a>:<br>
ä½ å¯ä»¥å°†å…¶ä¸ <code><a href="https://dplyr.tidyverse.org/reference/count.html">count()</a></code> ä¸€èµ·ä½¿ç”¨ï¼Œä»¥æŸ¥æ‰¾ç¾å›½å©´å„¿åå­—é•¿åº¦çš„åˆ†å¸ƒï¼Œç„¶åä¸ <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> ä¸€èµ·ä½¿ç”¨ï¼Œä»¥æŸ¥çœ‹æœ€é•¿çš„åå­—ï¼Œè¿™äº›åå­—æ°å¥½æœ‰ 15 ä¸ªå­—æ¯<sup>7</sup>ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">babynames</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_length.html">str_length</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span>, wt <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 14 Ã— 2</span></span>
<span><span class="co">#&gt;   length        n</span></span>
<span><span class="co">#&gt;    &lt;int&gt;    &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1      2   338150</span></span>
<span><span class="co">#&gt; 2      3  8589596</span></span>
<span><span class="co">#&gt; 3      4 48506739</span></span>
<span><span class="co">#&gt; 4      5 87011607</span></span>
<span><span class="co">#&gt; 5      6 90749404</span></span>
<span><span class="co">#&gt; 6      7 72120767</span></span>
<span><span class="co">#&gt; # â„¹ 8 more rows</span></span>
<span></span>
<span><span class="va">babynames</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_length.html">str_length</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="op">==</span> <span class="fl">15</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">name</span>, wt <span class="op">=</span> <span class="va">n</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 34 Ã— 2</span></span>
<span><span class="co">#&gt;   name                n</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;           &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 Franciscojavier   123</span></span>
<span><span class="co">#&gt; 2 Christopherjohn   118</span></span>
<span><span class="co">#&gt; 3 Johnchristopher   118</span></span>
<span><span class="co">#&gt; 4 Christopherjame   108</span></span>
<span><span class="co">#&gt; 5 Christophermich    52</span></span>
<span><span class="co">#&gt; 6 Ryanchristopher    45</span></span>
<span><span class="co">#&gt; # â„¹ 28 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="subsetting" class="level3" data-number="14.5.2"><h3 data-number="14.5.2" class="anchored" data-anchor-id="subsetting">
<span class="header-section-number">14.5.2</span> Subsetting</h3>
<p>You can extract parts of a string using <code>str_sub(string, start, end)</code>, where <code>start</code> and <code>end</code> are the positions where the substring should start and end. The <code>start</code> and <code>end</code> arguments are inclusive, so the length of the returned string will be <code>end - start + 1</code>:<br>
ä½ å¯ä»¥ä½¿ç”¨ <code>str_sub(string, start, end)</code> æ¥æå–å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ï¼Œå…¶ä¸­ <code>start</code> å’Œ <code>end</code> æ˜¯å­å­—ç¬¦ä¸²åº”è¯¥å¼€å§‹å’Œç»“æŸçš„ä½ç½®ã€‚<code>start</code> å’Œ <code>end</code> å‚æ•°æ˜¯åŒ…å«æ€§çš„ï¼Œæ‰€ä»¥è¿”å›çš„å­—ç¬¦ä¸²é•¿åº¦å°†æ˜¯ <code>end - start + 1</code>ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Apple"</span>, <span class="st">"Banana"</span>, <span class="st">"Pear"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "App" "Ban" "Pea"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can use negative values to count back from the end of the string: -1 is the last character, -2 is the second to last character, etc.<br>
ä½ å¯ä»¥ä½¿ç”¨è´Ÿå€¼ä»å­—ç¬¦ä¸²æœ«å°¾å‘åè®¡æ•°ï¼š-1 æ˜¯æœ€åä¸€ä¸ªå­—ç¬¦ï¼Œ-2 æ˜¯å€’æ•°ç¬¬äºŒä¸ªå­—ç¬¦ï¼Œä¾æ­¤ç±»æ¨ã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span><span class="op">(</span><span class="va">x</span>, <span class="op">-</span><span class="fl">3</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "ple" "ana" "ear"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that <code><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub()</a></code> wonâ€™t fail if the string is too short: it will just return as much as possible:<br>
è¯·æ³¨æ„ï¼Œå¦‚æœå­—ç¬¦ä¸²å¤ªçŸ­ï¼Œ<code><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub()</a></code> ä¸ä¼šå¤±è´¥ï¼šå®ƒåªä¼šå°½å¯èƒ½å¤šåœ°è¿”å›å†…å®¹ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "a"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We could use <code><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub()</a></code> with <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> to find the first and last letter of each name:<br>
æˆ‘ä»¬å¯ä»¥å°† <code><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub()</a></code> ä¸ <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> ç»“åˆä½¿ç”¨ï¼Œæ‰¾å‡ºæ¯ä¸ªåå­—çš„é¦–å­—æ¯å’Œå°¾å­—æ¯ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">babynames</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    first <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span><span class="op">(</span><span class="va">name</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    last <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span><span class="op">(</span><span class="va">name</span>, <span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1,924,665 Ã— 7</span></span>
<span><span class="co">#&gt;    year sex   name          n   prop first last </span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;     &lt;int&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1  1880 F     Mary       7065 0.0724 M     y    </span></span>
<span><span class="co">#&gt; 2  1880 F     Anna       2604 0.0267 A     a    </span></span>
<span><span class="co">#&gt; 3  1880 F     Emma       2003 0.0205 E     a    </span></span>
<span><span class="co">#&gt; 4  1880 F     Elizabeth  1939 0.0199 E     h    </span></span>
<span><span class="co">#&gt; 5  1880 F     Minnie     1746 0.0179 M     e    </span></span>
<span><span class="co">#&gt; 6  1880 F     Margaret   1578 0.0162 M     t    </span></span>
<span><span class="co">#&gt; # â„¹ 1,924,659 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="exercises-2" class="level3" data-number="14.5.3"><h3 data-number="14.5.3" class="anchored" data-anchor-id="exercises-2">
<span class="header-section-number">14.5.3</span> Exercises</h3>
<ol type="1">
<li>When computing the distribution of the length of babynames, why did we use <code>wt = n</code>?<br>
</li>
<li>Use <code><a href="https://stringr.tidyverse.org/reference/str_length.html">str_length()</a></code> and <code><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub()</a></code> to extract the middle letter from each baby name. What will you do if the string has an even number of characters?<br>
</li>
<li>Are there any major trends in the length of babynames over time? What about the popularity of first and last letters?</li>
</ol></section></section><section id="sec-other-languages" class="level2" data-number="14.6"><h2 data-number="14.6" class="anchored" data-anchor-id="sec-other-languages">
<span class="header-section-number">14.6</span> Non-English text</h2>
<p>So far, weâ€™ve focused on English language text which is particularly easy to work with for two reasons. Firstly, the English alphabet is relatively simple: there are just 26 letters. Secondly (and maybe more importantly), the computing infrastructure we use today was predominantly designed by English speakers. Unfortunately, we donâ€™t have room for a full treatment of non-English languages. Still, we wanted to draw your attention to some of the biggest challenges you might encounter: encoding, letter variations, and locale-dependent functions.<br>
åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸€ç›´ä¸“æ³¨äºè‹±æ–‡æ–‡æœ¬ï¼Œè¿™ç§æ–‡æœ¬ç‰¹åˆ«å®¹æ˜“å¤„ç†ï¼ŒåŸå› æœ‰äºŒã€‚é¦–å…ˆï¼Œè‹±æ–‡å­—æ¯ç›¸å¯¹ç®€å•ï¼šåªæœ‰ 26 ä¸ªå­—æ¯ã€‚å…¶æ¬¡ï¼ˆä¹Ÿè®¸æ›´é‡è¦çš„æ˜¯ï¼‰ï¼Œæˆ‘ä»¬ä»Šå¤©ä½¿ç”¨çš„è®¡ç®—åŸºç¡€è®¾æ–½ä¸»è¦æ˜¯ç”±è‹±è¯­ä½¿ç”¨è€…è®¾è®¡çš„ã€‚ä¸å¹¸çš„æ˜¯ï¼Œæˆ‘ä»¬æ²¡æœ‰è¶³å¤Ÿçš„ç¯‡å¹…æ¥å…¨é¢å¤„ç†éè‹±è¯­è¯­è¨€ã€‚ä¸è¿‡ï¼Œæˆ‘ä»¬æƒ³æé†’ä½ æ³¨æ„ä¸€äº›ä½ å¯èƒ½é‡åˆ°çš„æœ€å¤§æŒ‘æˆ˜ï¼šç¼–ç  (encoding)ã€å­—æ¯å˜ä½“å’Œä¾èµ–äºåŒºåŸŸè®¾ç½® (locale-dependent) çš„å‡½æ•°ã€‚</p>
<section id="encoding" class="level3" data-number="14.6.1"><h3 data-number="14.6.1" class="anchored" data-anchor-id="encoding">
<span class="header-section-number">14.6.1</span> Encoding</h3>
<p>When working with non-English text, the first challenge is often the <strong>encoding</strong>. To understand whatâ€™s going on, we need to dive into how computers represent strings. In R, we can get at the underlying representation of a string using <code><a href="https://rdrr.io/r/base/rawConversion.html">charToRaw()</a></code>:<br>
åœ¨å¤„ç†éè‹±æ–‡æ–‡æœ¬æ—¶ï¼Œç¬¬ä¸€ä¸ªæŒ‘æˆ˜é€šå¸¸æ˜¯<strong>ç¼–ç </strong> (encoding)ã€‚è¦ç†è§£å‘ç”Ÿäº†ä»€ä¹ˆï¼Œæˆ‘ä»¬éœ€è¦æ·±å…¥äº†è§£è®¡ç®—æœºå¦‚ä½•è¡¨ç¤ºå­—ç¬¦ä¸²ã€‚åœ¨ R ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code><a href="https://rdrr.io/r/base/rawConversion.html">charToRaw()</a></code> æ¥è·å–å­—ç¬¦ä¸²çš„åº•å±‚è¡¨ç¤ºï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rawConversion.html">charToRaw</a></span><span class="op">(</span><span class="st">"Hadley"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 48 61 64 6c 65 79</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Each of these six hexadecimal numbers represents one letter: <code>48</code> is H, <code>61</code> is a, and so on. The mapping from hexadecimal number to character is called the encoding, and in this case, the encoding is called ASCII. ASCII does a great job of representing English characters because itâ€™s the <strong>American</strong> Standard Code for Information Interchange.<br>
è¿™å…­ä¸ªåå…­è¿›åˆ¶æ•°ä¸­çš„æ¯ä¸€ä¸ªéƒ½ä»£è¡¨ä¸€ä¸ªå­—æ¯ï¼š<code>48</code> æ˜¯ Hï¼Œ<code>61</code> æ˜¯ aï¼Œä¾æ­¤ç±»æ¨ã€‚ä»åå…­è¿›åˆ¶æ•°åˆ°å­—ç¬¦çš„æ˜ å°„ç§°ä¸ºç¼–ç ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç¼–ç è¢«ç§°ä¸º ASCIIã€‚ASCII åœ¨è¡¨ç¤ºè‹±æ–‡å­—ç¬¦æ–¹é¢åšå¾—å¾ˆå¥½ï¼Œå› ä¸ºå®ƒæ˜¯<strong>ç¾å›½</strong>ä¿¡æ¯äº¤æ¢æ ‡å‡†ä»£ç ã€‚</p>
<p>Things arenâ€™t so easy for languages other than English. In the early days of computing, there were many competing standards for encoding non-English characters. For example, there were two different encodings for Europe: Latin1 (aka ISO-8859-1) was used for Western European languages, and Latin2 (aka ISO-8859-2) was used for Central European languages. In Latin1, the byte <code>b1</code> is â€œÂ±â€, but in Latin2, itâ€™s â€œÄ…â€! Fortunately, today there is one standard that is supported almost everywhere: UTF-8. UTF-8 can encode just about every character used by humans today and many extra symbols like emojis.<br>
å¯¹äºéè‹±è¯­è¯­è¨€æ¥è¯´ï¼Œäº‹æƒ…å°±æ²¡é‚£ä¹ˆç®€å•äº†ã€‚åœ¨è®¡ç®—çš„æ—©æœŸï¼Œæœ‰è®¸å¤šç«äº‰æ€§çš„æ ‡å‡†ç”¨äºç¼–ç éè‹±æ–‡å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œæ¬§æ´²æœ‰ä¸¤ç§ä¸åŒçš„ç¼–ç ï¼šLatin1ï¼ˆåˆå ISO-8859-1ï¼‰ç”¨äºè¥¿æ¬§è¯­è¨€ï¼Œè€Œ Latin2ï¼ˆåˆå ISO-8859-2ï¼‰ç”¨äºä¸­æ¬§è¯­è¨€ã€‚åœ¨ Latin1 ä¸­ï¼Œå­—èŠ‚ <code>b1</code> æ˜¯ â€œÂ±â€ï¼Œä½†åœ¨ Latin2 ä¸­ï¼Œå®ƒæ˜¯ â€œÄ…â€ï¼å¹¸è¿çš„æ˜¯ï¼Œå¦‚ä»Šæœ‰ä¸€ä¸ªå‡ ä¹åœ¨ä»»ä½•åœ°æ–¹éƒ½å¾—åˆ°æ”¯æŒçš„æ ‡å‡†ï¼šUTF-8ã€‚UTF-8 å‡ ä¹å¯ä»¥ç¼–ç å½“ä»Šäººç±»ä½¿ç”¨çš„æ‰€æœ‰å­—ç¬¦ä»¥åŠè®¸å¤šé¢å¤–çš„ç¬¦å·ï¼Œå¦‚è¡¨æƒ…ç¬¦å· (emojis)ã€‚</p>
<p>readr uses UTF-8 everywhere. This is a good default but will fail for data produced by older systems that donâ€™t use UTF-8. If this happens, your strings will look weird when you print them. Sometimes just one or two characters might be messed up; other times, youâ€™ll get complete gibberish. For example here are two inline CSVs with unusual encodings<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>:<br>
readr åœ¨ä»»ä½•åœ°æ–¹éƒ½ä½¿ç”¨ UTF-8ã€‚è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é»˜è®¤è®¾ç½®ï¼Œä½†å¯¹äºç”±ä¸ä½¿ç”¨ UTF-8 çš„æ—§ç³»ç»Ÿç”Ÿæˆçš„æ•°æ®ï¼Œå®ƒä¼šå¤±è´¥ã€‚å¦‚æœå‘ç”Ÿè¿™ç§æƒ…å†µï¼Œä½ çš„å­—ç¬¦ä¸²åœ¨æ‰“å°æ—¶ä¼šçœ‹èµ·æ¥å¾ˆå¥‡æ€ªã€‚æœ‰æ—¶å¯èƒ½åªæœ‰ä¸€ä¸¤ä¸ªå­—ç¬¦è¢«å¼„ä¹±ï¼›å…¶ä»–æ—¶å€™ï¼Œä½ ä¼šå¾—åˆ°å®Œå…¨çš„ä¹±ç ã€‚ä¾‹å¦‚ï¼Œè¿™é‡Œæœ‰ä¸¤ä¸ªå¸¦æœ‰ä¸å¯»å¸¸ç¼–ç çš„å†…è” CSV<sup>8</sup>ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="st">"text\nEl Ni\xf1o was particularly bad this year"</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span><span class="op">$</span><span class="va">text</span></span>
<span><span class="co">#&gt; [1] "El Ni\xf1o was particularly bad this year"</span></span>
<span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="st">"text\n\x82\xb1\x82\xf1\x82\xc9\x82\xbf\x82\xcd"</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span><span class="op">$</span><span class="va">text</span></span>
<span><span class="co">#&gt; [1] "\x82\xb1\x82\xf1\x82É‚\xbf\x82\xcd"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To read these correctly, you specify the encoding via the <code>locale</code> argument:<br>
è¦æ­£ç¡®è¯»å–è¿™äº›æ–‡ä»¶ï¼Œä½ éœ€è¦é€šè¿‡ <code>locale</code> å‚æ•°æŒ‡å®šç¼–ç ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="va">x1</span>, locale <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/locale.html">locale</a></span><span class="op">(</span>encoding <span class="op">=</span> <span class="st">"Latin1"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">text</span></span>
<span><span class="co">#&gt; [1] "El NiÃ±o was particularly bad this year"</span></span>
<span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="va">x2</span>, locale <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/locale.html">locale</a></span><span class="op">(</span>encoding <span class="op">=</span> <span class="st">"Shift-JIS"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">text</span></span>
<span><span class="co">#&gt; [1] "ã“ã‚“ã«ã¡ã¯"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>How do you find the correct encoding? If youâ€™re lucky, itâ€™ll be included somewhere in the data documentation. Unfortunately, thatâ€™s rarely the case, so readr provides <code><a href="https://readr.tidyverse.org/reference/encoding.html">guess_encoding()</a></code> to help you figure it out. Itâ€™s not foolproof and works better when you have lots of text (unlike here), but itâ€™s a reasonable place to start. Expect to try a few different encodings before you find the right one.<br>
ä½ å¦‚ä½•æ‰¾åˆ°æ­£ç¡®çš„ç¼–ç ï¼Ÿå¦‚æœå¹¸è¿çš„è¯ï¼Œå®ƒä¼šåŒ…å«åœ¨æ•°æ®æ–‡æ¡£çš„æŸä¸ªåœ°æ–¹ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¿™ç§æƒ…å†µå¾ˆå°‘è§ï¼Œæ‰€ä»¥ readr æä¾›äº† <code><a href="https://readr.tidyverse.org/reference/encoding.html">guess_encoding()</a></code> æ¥å¸®åŠ©ä½ ç¡®å®šå®ƒã€‚å®ƒå¹¶éä¸‡æ— ä¸€å¤±ï¼Œå¹¶ä¸”åœ¨ä½ æ‹¥æœ‰å¤§é‡æ–‡æœ¬æ—¶æ•ˆæœæ›´å¥½ï¼ˆä¸åƒè¿™é‡Œï¼‰ï¼Œä½†å®ƒæ˜¯ä¸€ä¸ªåˆç†çš„èµ·ç‚¹ã€‚é¢„è®¡ä½ éœ€è¦å°è¯•å‡ ç§ä¸åŒçš„ç¼–ç æ‰èƒ½æ‰¾åˆ°æ­£ç¡®çš„é‚£ä¸€ä¸ªã€‚</p>
<p>Encodings are a rich and complex topic; weâ€™ve only scratched the surface here. If youâ€™d like to learn more, we recommend reading the detailed explanation at <a href="http://kunststube.net/encoding/">http://kunststube.net/encoding/</a>.<br>
ç¼–ç æ˜¯ä¸€ä¸ªå†…å®¹ä¸°å¯Œä¸”å¤æ‚çš„ä¸»é¢˜ï¼›æˆ‘ä»¬åœ¨è¿™é‡Œåªæ˜¯æµ…å°è¾„æ­¢ã€‚å¦‚æœä½ æƒ³äº†è§£æ›´å¤šï¼Œæˆ‘ä»¬å»ºè®®é˜…è¯» <a href="http://kunststube.net/encoding/">http://kunststube.net/encoding/</a> ä¸Šçš„è¯¦ç»†è§£é‡Šã€‚</p>
</section><section id="letter-variations" class="level3" data-number="14.6.2"><h3 data-number="14.6.2" class="anchored" data-anchor-id="letter-variations">
<span class="header-section-number">14.6.2</span> Letter variations</h3>
<p>Working in languages with accents poses a significant challenge when determining the position of letters (e.g., with <code><a href="https://stringr.tidyverse.org/reference/str_length.html">str_length()</a></code> and <code><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub()</a></code>) as accented letters might be encoded as a single individual character (e.g., Ã¼) or as two characters by combining an unaccented letter (e.g., u) with a diacritic mark (e.g., Â¨). For example, this code shows two ways of representing Ã¼ that look identical:<br>
åœ¨å¤„ç†å¸¦é‡éŸ³ç¬¦å·çš„è¯­è¨€æ—¶ï¼Œç¡®å®šå­—æ¯çš„ä½ç½®ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨ <code><a href="https://stringr.tidyverse.org/reference/str_length.html">str_length()</a></code> å’Œ <code><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub()</a></code>ï¼‰ä¼šå¸¦æ¥é‡å¤§æŒ‘æˆ˜ï¼Œå› ä¸ºå¸¦é‡éŸ³çš„å­—æ¯å¯èƒ½è¢«ç¼–ç ä¸ºå•ä¸ªç‹¬ç«‹å­—ç¬¦ï¼ˆä¾‹å¦‚ï¼ŒÃ¼ï¼‰ï¼Œæˆ–è€…é€šè¿‡ç»„åˆä¸€ä¸ªä¸å¸¦é‡éŸ³çš„å­—æ¯ï¼ˆä¾‹å¦‚ï¼Œuï¼‰å’Œä¸€ä¸ªå˜éŸ³ç¬¦å·ï¼ˆä¾‹å¦‚ï¼ŒÂ¨ï¼‰è€Œè¢«ç¼–ç ä¸ºä¸¤ä¸ªå­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œè¿™æ®µä»£ç æ˜¾ç¤ºäº†ä¸¤ç§çœ‹èµ·æ¥å®Œå…¨ç›¸åŒçš„è¡¨ç¤º Ã¼ çš„æ–¹å¼ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">u</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"\u00fc"</span>, <span class="st">"u\u0308"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_view.html">str_view</a></span><span class="op">(</span><span class="va">u</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] â”‚ Ã¼</span></span>
<span><span class="co">#&gt; [2] â”‚ uÌˆ</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>But both strings differ in length, and their first characters are different:<br>
ä½†è¿™ä¸¤ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦ä¸åŒï¼Œå®ƒä»¬çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¹Ÿä¸åŒï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_length.html">str_length</a></span><span class="op">(</span><span class="va">u</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1 2</span></span>
<span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span><span class="op">(</span><span class="va">u</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Ã¼" "u"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, note that a comparison of these strings with <code>==</code> interprets these strings as different, while the handy <code><a href="https://stringr.tidyverse.org/reference/str_equal.html">str_equal()</a></code> function in stringr recognizes that both have the same appearance:<br>
æœ€åï¼Œè¯·æ³¨æ„ï¼Œä½¿ç”¨ <code>==</code> æ¯”è¾ƒè¿™äº›å­—ç¬¦ä¸²ä¼šå°†å…¶è§£é‡Šä¸ºä¸åŒçš„å­—ç¬¦ä¸²ï¼Œè€Œ stringr ä¸­æ–¹ä¾¿çš„ <code><a href="https://stringr.tidyverse.org/reference/str_equal.html">str_equal()</a></code> å‡½æ•°åˆ™èƒ½è¯†åˆ«å‡ºä¸¤è€…å…·æœ‰ç›¸åŒçš„å¤–è§‚ï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">u</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">==</span> <span class="va">u</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span></span>
<span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_equal.html">str_equal</a></span><span class="op">(</span><span class="va">u</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">u</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="locale-dependent-functions" class="level3" data-number="14.6.3"><h3 data-number="14.6.3" class="anchored" data-anchor-id="locale-dependent-functions">
<span class="header-section-number">14.6.3</span> Locale-dependent functions</h3>
<p>Finally, there are a handful of stringr functions whose behavior depends on your <strong>locale</strong>. A locale is similar to a language but includes an optional region specifier to handle regional variations within a language. A locale is specified by a lower-case language abbreviation, optionally followed by a <code>_</code> and an upper-case region identifier. For example, â€œenâ€ is English, â€œen_GBâ€ is British English, and â€œen_USâ€ is American English. If you donâ€™t already know the code for your language, <a href="https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes">Wikipedia</a> has a good list, and you can see which are supported in stringr by looking at <code><a href="https://rdrr.io/pkg/stringi/man/stri_locale_list.html">stringi::stri_locale_list()</a></code>.<br>
æœ€åï¼Œè¿˜æœ‰ä¸€äº› stringr å‡½æ•°çš„è¡Œä¸ºå–å†³äºä½ çš„<strong>åŒºåŸŸè®¾ç½®</strong> (locale)ã€‚locale ç±»ä¼¼äºä¸€ç§è¯­è¨€ï¼Œä½†åŒ…å«ä¸€ä¸ªå¯é€‰çš„åŒºåŸŸè¯´æ˜ç¬¦ï¼Œä»¥å¤„ç†ä¸€ç§è¯­è¨€å†…éƒ¨çš„åŒºåŸŸå·®å¼‚ã€‚locale ç”±å°å†™è¯­è¨€ç¼©å†™æŒ‡å®šï¼Œåé¢å¯é€‰æ‹©æ€§åœ°è·Ÿä¸€ä¸ª <code>_</code> å’Œä¸€ä¸ªå¤§å†™çš„åŒºåŸŸæ ‡è¯†ç¬¦ã€‚ä¾‹å¦‚ï¼Œâ€œenâ€ æ˜¯è‹±è¯­ï¼Œâ€œen_GBâ€ æ˜¯è‹±å¼è‹±è¯­ï¼Œâ€œen_USâ€ æ˜¯ç¾å¼è‹±è¯­ã€‚å¦‚æœä½ è¿˜ä¸çŸ¥é“ä½ è¯­è¨€çš„ä»£ç ï¼Œ<a href="https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes">ç»´åŸºç™¾ç§‘</a> æœ‰ä¸€ä¸ªå¾ˆå¥½çš„åˆ—è¡¨ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡æŸ¥çœ‹ <code><a href="https://rdrr.io/pkg/stringi/man/stri_locale_list.html">stringi::stri_locale_list()</a></code> æ¥çœ‹ stringr æ”¯æŒå“ªäº›ã€‚</p>
<p>Base R string functions automatically use the locale set by your operating system. This means that base R string functions do what you expect for your language, but your code might work differently if you share it with someone who lives in a different country. To avoid this problem, stringr defaults to English rules by using the â€œenâ€ locale and requires you to specify the <code>locale</code> argument to override it. Fortunately, there are only two sets of functions where the locale really matters: changing case and sorting.<br>
åŸºç¡€ R å­—ç¬¦ä¸²å‡½æ•°ä¼šè‡ªåŠ¨ä½¿ç”¨ä½ çš„æ“ä½œç³»ç»Ÿè®¾ç½®çš„ localeã€‚è¿™æ„å‘³ç€åŸºç¡€ R å­—ç¬¦ä¸²å‡½æ•°ä¼šæŒ‰ç…§ä½ è¯­è¨€çš„é¢„æœŸå·¥ä½œï¼Œä½†å¦‚æœä½ çš„ä»£ç ä¸ç”Ÿæ´»åœ¨ä¸åŒå›½å®¶çš„äººå…±äº«ï¼Œå®ƒçš„å·¥ä½œæ–¹å¼å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚ä¸ºé¿å…æ­¤é—®é¢˜ï¼Œstringr é»˜è®¤ä½¿ç”¨ â€œenâ€ localeï¼Œå³è‹±è¯­è§„åˆ™ï¼Œå¹¶è¦æ±‚ä½ æŒ‡å®š <code>locale</code> å‚æ•°æ¥è¦†ç›–å®ƒã€‚å¹¸è¿çš„æ˜¯ï¼Œåªæœ‰ä¸¤ç»„å‡½æ•°çš„ locale çœŸæ­£é‡è¦ï¼šæ”¹å˜å¤§å°å†™å’Œæ’åºã€‚</p>
<p>The rules for changing cases differ among languages. For example, Turkish has two iâ€™s: with and without a dot. Since theyâ€™re two distinct letters, theyâ€™re capitalized differently:<br>
ä¸åŒè¯­è¨€çš„å¤§å°å†™è½¬æ¢è§„åˆ™ä¸åŒã€‚ä¾‹å¦‚ï¼ŒåœŸè€³å…¶è¯­ä¸­æœ‰ä¸¤ä¸ª iï¼šå¸¦ç‚¹çš„å’Œä¸å¸¦ç‚¹çš„ã€‚ç”±äºå®ƒä»¬æ˜¯ä¸¤ä¸ªä¸åŒçš„å­—æ¯ï¼Œå®ƒä»¬çš„å¤§å†™æ–¹å¼ä¹Ÿä¸åŒï¼š</p>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html">str_to_upper</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"i"</span>, <span class="st">"Ä±"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "I" "I"</span></span>
<span><span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html">str_to_upper</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"i"</span>, <span class="st">"Ä±"</span><span class="op">)</span>, locale <span class="op">=</span> <span class="st">"tr"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Ä°" "I"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Sorting strings depends on the order of the alphabet, and the order of the alphabet is not the same in every language<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a>! Hereâ€™s an example: in Czech, â€œchâ€ is a compound letter that appears after <code>h</code> in the alphabet.<br>
å­—ç¬¦ä¸²æ’åºå–å†³äºå­—æ¯è¡¨çš„é¡ºåºï¼Œè€Œå¹¶éæ¯ç§è¯­è¨€çš„å­—æ¯è¡¨é¡ºåºéƒ½ç›¸åŒ<sup>9</sup>ï¼è¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­ï¼šåœ¨æ·å…‹è¯­ä¸­ï¼Œâ€œchâ€ æ˜¯ä¸€ä¸ªå¤åˆå­—æ¯ï¼Œåœ¨å­—æ¯è¡¨ä¸­å‡ºç°åœ¨ <code>h</code> ä¹‹åã€‚</p>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_order.html">str_sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"c"</span>, <span class="st">"ch"</span>, <span class="st">"h"</span>, <span class="st">"z"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "a"  "c"  "ch" "h"  "z"</span></span>
<span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_order.html">str_sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"c"</span>, <span class="st">"ch"</span>, <span class="st">"h"</span>, <span class="st">"z"</span><span class="op">)</span>, locale <span class="op">=</span> <span class="st">"cs"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "a"  "c"  "h"  "ch" "z"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This also comes up when sorting strings with <code><a href="https://dplyr.tidyverse.org/reference/arrange.html">dplyr::arrange()</a></code>, which is why it also has a <code>locale</code> argument.<br>
åœ¨ä½¿ç”¨ <code><a href="https://dplyr.tidyverse.org/reference/arrange.html">dplyr::arrange()</a></code> å¯¹å­—ç¬¦ä¸²è¿›è¡Œæ’åºæ—¶ä¹Ÿä¼šé‡åˆ°è¿™ç§æƒ…å†µï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒä¹Ÿæœ‰ä¸€ä¸ª <code>locale</code> å‚æ•°ã€‚</p>
</section></section><section id="summary" class="level2" data-number="14.7"><h2 data-number="14.7" class="anchored" data-anchor-id="summary">
<span class="header-section-number">14.7</span> Summary</h2>
<p>In this chapter, youâ€™ve learned about some of the power of the stringr package: how to create, combine, and extract strings, and about some of the challenges you might face with non-English strings. Now itâ€™s time to learn one of the most important and powerful tools for working with strings: regular expressions. Regular expressions are a very concise but very expressive language for describing patterns within strings and are the topic of the next chapter.<br>
åœ¨æœ¬ç« ä¸­ï¼Œä½ å­¦ä¹ äº† stringr åŒ…çš„ä¸€äº›å¼ºå¤§åŠŸèƒ½ï¼šå¦‚ä½•åˆ›å»ºã€ç»„åˆå’Œæå–å­—ç¬¦ä¸²ï¼Œä»¥åŠåœ¨å¤„ç†éè‹±è¯­å­—ç¬¦ä¸²æ—¶å¯èƒ½é¢ä¸´çš„ä¸€äº›æŒ‘æˆ˜ã€‚ç°åœ¨æ˜¯æ—¶å€™å­¦ä¹ å¤„ç†å­—ç¬¦ä¸²æœ€é‡è¦å’Œæœ€å¼ºå¤§çš„å·¥å…·ä¹‹ä¸€ï¼šæ­£åˆ™è¡¨è¾¾å¼ã€‚æ­£åˆ™è¡¨è¾¾å¼æ˜¯ä¸€ç§éå¸¸ç®€æ´ä½†è¡¨è¾¾èƒ½åŠ›æå¼ºçš„è¯­è¨€ï¼Œç”¨äºæè¿°å­—ç¬¦ä¸²å†…çš„æ¨¡å¼ï¼Œè¿™ä¹Ÿæ˜¯ä¸‹ä¸€ç« çš„ä¸»é¢˜ã€‚</p>


</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>Or use the base R function <code><a href="https://rdrr.io/r/base/writeLines.html">writeLines()</a></code>.<a href="#fnref1" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn2"><p>Available in R 4.0.0 and above.<a href="#fnref2" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn3"><p><code><a href="https://stringr.tidyverse.org/reference/str_view.html">str_view()</a></code> also uses color to bring tabs, spaces, matches, etc. to your attention. The colors donâ€™t currently show up in the book, but youâ€™ll notice them when running code interactively.<a href="#fnref3" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn4"><p>If youâ€™re not using stringr, you can also access it directly with <code><a href="https://glue.tidyverse.org/reference/glue.html">glue::glue()</a></code>.<a href="#fnref4" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn5"><p>The base R equivalent is <code><a href="https://rdrr.io/r/base/paste.html">paste()</a></code> used with the <code>collapse</code> argument.<a href="#fnref5" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn6"><p>The same principles apply to <code><a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html">separate_wider_position()</a></code> and <code><a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html">separate_wider_regex()</a></code>.<a href="#fnref6" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn7"><p>Looking at these entries, weâ€™d guess that the babynames data drops spaces or hyphens and truncates after 15 letters.<a href="#fnref7" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn8"><p>Here Iâ€™m using the special <code>\x</code> to encode binary data directly into a string.<a href="#fnref8" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
<li id="fn9"><p>Sorting in languages that donâ€™t have an alphabet, like Chinese, is more complicated still.<a href="#fnref9" class="footnote-back" role="doc-backlink">â†©ï¸</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/ggvispro\.github\.io\/r4ds-cn\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./numbers.html" class="pagination-link" aria-label="Numbers">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Numbers</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./regexps.html" class="pagination-link" aria-label="Regular expressions">
        <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Regular expressions</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ggvisPro/r4ds-cn/edit/main/strings.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/ggvisPro/r4ds-cn/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>